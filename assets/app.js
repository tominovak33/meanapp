angular.module("app",["ngRoute","ngAnimate"]),angular.module("app").controller("ApplicationCtrl",["$scope","$rootScope","UserSvc",function(e,t,n){e.baseUrl=location.host,window.localStorage.token&&n.getUser().then(function(t){e.$emit("userLoggedIn",t.data)}),e.$on("userLoggedIn",function(t,n){e.currentUser=n})}]).filter("output_html",["$sce",function(e){return function(t){return e.trustAsHtml(t)}}]).filter("startFrom",function(){return function(e,t){return e?(t=+t,e.slice(t)):[]}}),angular.module("app").directive("staticInclude",["$http","$templateCache","$compile",function(e,t,n){return function(o,r,s){var i=s.staticInclude;e.get(i,{cache:t}).success(function(e){var t=r.html(e).contents();n(t)(o)})}}]),angular.module("app").controller("LoginCtrl",["$scope","UserSvc",function(e,t){e.login=function(n,o){t.login(n,o).then(function(t){e.$emit("userLoggedIn",t.data),window.location.href="#/"},function(t){e.loginValidation="Incorrect username & password combination"})},e.logout=function(){t.logout()}}]),angular.module("app").controller("PostsCtrl",["$scope","$http","PostsService","filterFilter","UserSvc","$timeout",function(e,t,n,o,r,s){e.baseUrl=location.host,e.bodyLengthLimit=250,e.postTagsArray=[],e.ckLoaded=!1,e.posts=[],e.addPost=function(){try{var t=CKEDITOR.instances.editor1.getData()}catch(o){console.error("CKEDITOR has not been loaded")}if(!t)var t=e.postContent;var r=e.urlDate(),s=e.slugify(e.postTitle),i=r+s;t&&n.send({body:t,title:e.postTitle,tags:e.postTagsArray,slug:i}).success(function(t){e.postBody=null,CKEDITOR.instances.editor1.setData(""),e.postTitle=null})},e.$on("$includeContentLoaded",function(){e.init_ckeditor()}),e.init_ckeditor=function(){e.ckLoaded=!0;try{{CKEDITOR.replace("editor1")}}catch(t){e.ckLoaded=!1,console.log("Error: "+t)}},e.$on("ws:new_post",function(t,n){n=n[0],e.$apply(function(){e.posts.unshift(n),e.paginate()})}),e.$on("$viewContentLoaded",function(){}),e.currentPage=1,e.postsPerPage=5,e.prevPage=function(){e.currentPage>1&&e.currentPage--},e.nextPage=function(){e.currentPage<e.posts.length/e.postsPerPage&&e.currentPage++},e.setPage=function(t){e.currentPage=t},e.range=function(e){return new Array(e)},e.$watch("search",function(t){e.filteredPosts=o(e.posts,t),e.paginate(e.filteredPosts.length)},!0),e.paginate=function(t){e.numberOfPages=Math.ceil(t>0?t/e.postsPerPage:e.posts.length/e.postsPerPage)},e.urlDate=function(e){if(void 0===e)var t=new Date;else var t=new Date(e);var n=t.getDate(),o=t.getMonth()+1,r=t.getFullYear();return String(r)+"/"+String(o)+"/"+String(n)+"/"},e.$watch("postTitle",function(t){t&&e.generateSlug(t)},!0),e.generateSlug=function(){e.slug=e.urlDate()+e.slugify(e.postTitle)},e.slugify=function(e){var t=e.toLowerCase();return t=t.replace(/\s+/g,"-"),t=t.replace(/\?/g,""),t=t.replace(/\&/g,""),t=t.replace(/\=/g,"")},e.addTag=function(t){e.postTagsArray.push(t),e.postTag=""},e.removeTag=function(t){e.postTagsArray.splice(t,1)},n.get().success(function(t){e.posts=t,e.paginate(e.posts.length)})}]),angular.module("app").service("PostsService",["$http",function(e){this.get=function(){return e.get("/api/posts")},this.send=function(t){return e.post("/api/posts",t)},this.removeItem=function(t){return e.post("/api/posts/removeItem",{params:{post_id:t.post_id}})},this.single_slug=function(t){return e.get("/api/posts",{params:{post_slug:t.slug}})},this.single_id=function(t){return e.get("/api/posts",{params:{post_id:t.id}})},this.user_posts=function(t){return e.get("/api/posts",{params:{_author:t._author}})}}]),angular.module("app").controller("ProfileCtrl",["$scope","$http","UserSvc","PostsService","$routeParams","$route","$location",function(e,t,n,o,r,s,i){e.editPermission=function(t){n.authorization().then(function(t){e=t})},e.baseUrl=location.host;var a=r.username;e["new"]={},n.profile(a).success(function(t){e.user_profile=t,o.user_posts({_author:e.user_profile._id}).success(function(t){e.user_posts=t,e.paginate(e.user_posts.length)})}),e.checkLogin=function(){window.localStorage.token&&n.getUser().then(function(t){e.currentUser=t.data,(e.user_profile._id==e.currentUser._id||e.editPermission(e.currentUser.permission_level))&&(e.canEdit=!0)})},e.currentUser=[],e.checkLogin(),e.$on("$viewContentLoaded",function(){}),e.user_posts=[],e.currentPage=1,e.postsPerPage=5,e.prevPage=function(){e.currentPage>1&&e.currentPage--},e.nextPage=function(){e.currentPage<e.user_posts.length/e.postsPerPage&&e.currentPage++},e.setPage=function(t){e.currentPage=t},e.range=function(e){return new Array(e)},e.paginate=function(t){e.numberOfPages=Math.ceil(t>0?t/e.postsPerPage:e.user_posts.length/e.postsPerPage)},e.range=function(e){return new Array(e)},n.authorization("10").then(function(e){console.log(e)}),e.saveProfile=function(){var t={_id:e.user_profile._id};for(var o in e["new"])e["new"].hasOwnProperty(o)&&""!=e["new"][o]&&(t[o]=e["new"][o]);n.profileUpdate(t).success(function(t){t.username!=e.user_profile.username?(e.returnMessage="Your username was changed so you must log in again",setTimeout(function(){window.location.href="/#/login"},1500)):e.returnMessage="Details updated successfully"})}}]),angular.module("app").controller("RegisterCtrl",["$scope","UserSvc",function(e,t){e.register=function(n,o,r){return o!=r?void(e.validationMessage="Your passwords did not match."):void t.register(n,o)}}]),angular.module("app").config(["$routeProvider",function(e){e.when("/",{controller:"PostsCtrl",templateUrl:"posts.html"}).when("/register",{controller:"RegisterCtrl",templateUrl:"register.html"}).when("/login",{controller:"LoginCtrl",templateUrl:"login.html"}).when("/logout",{controller:"LoginCtrl",templateUrl:"logout.html"}).when("/post/:year/:month/:day/:slug",{controller:"SinglePostCtrl",templateUrl:"singlePost.html"}).when("/post/id/:id",{controller:"SinglePostCtrl",templateUrl:"singlePost.html"}).when("/user/:username",{controller:"ProfileCtrl",templateUrl:"user.html"}).when("/user/:username/edit",{controller:"ProfileCtrl",templateUrl:"profile/userProfile.html"})}]),angular.module("app").controller("SinglePostCtrl",["$scope","$http","PostsService","$routeParams","$route","$location",function(e,t,n,o,r,s){e.$on("$viewContentLoaded",function(){}),e.deleteItem=function(){n.removeItem({post_id:e.post._id}).success(function(e){console.log(e)})};var i=o.slug,a=o.id;if(i){var u="";u+=o.year+"/",u+=o.month+"/",u+=o.day+"/",u+=o.slug,console.log(u),n.single_slug({slug:u}).success(function(t){e.post=t[0],console.log(e.post)})}else a&&n.single_id({id:a}).success(function(t){e.post=t[0],console.log(e.post)})}]),angular.module("app").service("UserSvc",["$http",function(e){var t=this;t.getUser=function(){return e.defaults.headers.common["X-Auth"]=window.localStorage.token,e.get("/api/users").then(function(e){return e})},t.login=function(n,o){return e.post("/api/sessions",{username:n,password:o}).then(function(n){return window.localStorage.token=n.data,e.defaults.headers.common["X-Auth"]=n.data,t.getUser()})},t.register=function(n,o,r){return e.post("/api/users",{username:n,password:o}).then(function(e){return t.login(n,o).then(function(){window.location.href="/"})})},t.authorization=function(t){return e.defaults.headers.common["X-Auth"]=window.localStorage.token,e.get("/api/users/permissions").then(function(e){return console.log(e),e.data>t?!0:!1})},t.logout=function(){window.localStorage.removeItem("token"),window.location.href="/"},t.profile=function(t){return e.get("/api/users/profile",{params:{username:t}})},t.profileUpdate=function(t){return e.post("/api/users/profile",t)}}]),angular.module("app").run(["$rootScope","$timeout","$window",function(e,t,n){var o=10;!function r(){o+=o;var s="ws://"+n.location.host,i=new WebSocket(s);i.onopen=function(){},i.onclose=function(e){console.log("Websocket connection closed. Attempting to recconnect in "+o+" seconds"),t(r,1e3*o)},i.onmessage=function(t){var n=JSON.parse(t.data),o="ws:"+n.topic,r=n.data;e.$broadcast(o,r)}}()}]);
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1vZHVsZS5qcyIsImFwcGxpY2F0aW9uQ3RybC5qcyIsImN1c3RvbURpcmVjdGl2ZXMuanMiLCJsb2dpbkNydGwuanMiLCJwb3N0c0N0cmwuanMiLCJwb3N0c1NlcnZpY2UuanMiLCJwcm9maWxlQ3RybC5qcyIsInJlZ2lzdHJhdGlvbkN0cmwuanMiLCJyb3V0ZXMuanMiLCJzaW5nbGVQb3N0c0N0cmwuanMiLCJ1c2VyU2VydmljZS5qcyIsIndlYnNvY2tldHMuanMiXSwibmFtZXMiOlsiYW5ndWxhciIsIm1vZHVsZSIsImNvbnRyb2xsZXIiLCIkc2NvcGUiLCIkcm9vdFNjb3BlIiwiVXNlclN2YyIsImJhc2VVcmwiLCJsb2NhdGlvbiIsImhvc3QiLCJ3aW5kb3ciLCJsb2NhbFN0b3JhZ2UiLCJ0b2tlbiIsImdldFVzZXIiLCJ0aGVuIiwicmVzcG9uc2UiLCIkZW1pdCIsImRhdGEiLCIkb24iLCJldmVudCIsInVzZXIiLCJjdXJyZW50VXNlciIsImZpbHRlciIsIiRzY2UiLCJ2YWwiLCJ0cnVzdEFzSHRtbCIsImlucHV0Iiwic3RhcnQiLCJzbGljZSIsImRpcmVjdGl2ZSIsIiRodHRwIiwiJHRlbXBsYXRlQ2FjaGUiLCIkY29tcGlsZSIsInNjb3BlIiwiZWxlbWVudCIsImF0dHJzIiwidGVtcGxhdGVQYXRoIiwic3RhdGljSW5jbHVkZSIsImdldCIsImNhY2hlIiwic3VjY2VzcyIsImNvbnRlbnRzIiwiaHRtbCIsImxvZ2luIiwidXNlcm5hbWUiLCJwYXNzd29yZCIsImhyZWYiLCJlcnJvciIsImxvZ2luVmFsaWRhdGlvbiIsImxvZ291dCIsIlBvc3RzU2VydmljZSIsImZpbHRlckZpbHRlciIsIiR0aW1lb3V0IiwiYm9keUxlbmd0aExpbWl0IiwicG9zdFRhZ3NBcnJheSIsImNrTG9hZGVkIiwicG9zdHMiLCJhZGRQb3N0IiwicG9zdENvbnRlbnQiLCJDS0VESVRPUiIsImluc3RhbmNlcyIsImVkaXRvcjEiLCJnZXREYXRhIiwiZXJyIiwiY29uc29sZSIsImRhdGVfc2x1ZyIsInVybERhdGUiLCJ0aXRsZV9zbHVnIiwic2x1Z2lmeSIsInBvc3RUaXRsZSIsInNsdWciLCJzZW5kIiwiYm9keSIsInRpdGxlIiwidGFncyIsInBvc3QiLCJwb3N0Qm9keSIsInNldERhdGEiLCJpbml0X2NrZWRpdG9yIiwicmVwbGFjZSIsImxvZyIsIl8iLCIkYXBwbHkiLCJ1bnNoaWZ0IiwicGFnaW5hdGUiLCJjdXJyZW50UGFnZSIsInBvc3RzUGVyUGFnZSIsInByZXZQYWdlIiwibmV4dFBhZ2UiLCJsZW5ndGgiLCJzZXRQYWdlIiwicGFnZV9udW1iZXIiLCJyYW5nZSIsIm4iLCJBcnJheSIsIiR3YXRjaCIsInRlcm0iLCJmaWx0ZXJlZFBvc3RzIiwibnVtYmVyX29mX2l0ZW1zIiwibnVtYmVyT2ZQYWdlcyIsIk1hdGgiLCJjZWlsIiwidGltZSIsInVuZGVmaW5lZCIsImRhdGUiLCJEYXRlIiwiZGF5IiwiZ2V0RGF0ZSIsIm1vbnRoIiwiZ2V0TW9udGgiLCJ5ZWFyIiwiZ2V0RnVsbFllYXIiLCJTdHJpbmciLCJnZW5lcmF0ZVNsdWciLCJzdHJpbmciLCJ0b0xvd2VyQ2FzZSIsImFkZFRhZyIsInRhZyIsInB1c2giLCJwb3N0VGFnIiwicmVtb3ZlVGFnIiwidGFnSW5kZXgiLCJzcGxpY2UiLCJzZXJ2aWNlIiwidGhpcyIsInJlbW92ZUl0ZW0iLCJwYXJhbWV0ZXJzIiwicGFyYW1zIiwicG9zdF9pZCIsInNpbmdsZV9zbHVnIiwicG9zdF9zbHVnIiwic2luZ2xlX2lkIiwiaWQiLCJ1c2VyX3Bvc3RzIiwiX2F1dGhvciIsIiRyb3V0ZVBhcmFtcyIsIiRyb3V0ZSIsIiRsb2NhdGlvbiIsImVkaXRQZXJtaXNzaW9uIiwicGVybWlzc2lvbl9sZXZlbCIsImF1dGhvcml6YXRpb24iLCJwcm9maWxlIiwidXNlcl9wcm9maWxlIiwiX2lkIiwiY2hlY2tMb2dpbiIsImNhbkVkaXQiLCJzYXZlUHJvZmlsZSIsInByb2ZpbGVfZGV0YWlscyIsImtleSIsImhhc093blByb3BlcnR5IiwicHJvZmlsZVVwZGF0ZSIsInJldHVybk1lc3NhZ2UiLCJzZXRUaW1lb3V0IiwicmVnaXN0ZXIiLCJwYXNzd29yZF9jb25maXJtIiwidmFsaWRhdGlvbk1lc3NhZ2UiLCJjb25maWciLCIkcm91dGVQcm92aWRlciIsIndoZW4iLCJ0ZW1wbGF0ZVVybCIsImRlbGV0ZUl0ZW0iLCJwb3N0U2x1ZyIsInBvc3RJRCIsImZ1bGxQb3N0U2x1ZyIsInN2YyIsImRlZmF1bHRzIiwiaGVhZGVycyIsImNvbW1vbiIsInJ1biIsIiR3aW5kb3ciLCJyZWNvbm5lY3RfZGVsYXkiLCJjb25uZWN0IiwiY29ubmVjdGlvbiIsIldlYlNvY2tldCIsIm9ub3BlbiIsIm9uY2xvc2UiLCJlIiwib25tZXNzYWdlIiwibWVzc2FnZSIsIkpTT04iLCJwYXJzZSIsIm5hbWUiLCJ0b3BpYyIsIiRicm9hZGNhc3QiXSwibWFwcGluZ3MiOiJBQUNBQSxRQUFBQyxPQUFBLE9BQUEsVUFBQSxjQ0RBRCxRQUFBQyxPQUFBLE9BQ0FDLFdBQUEsbUJBQUEsU0FBQSxhQUFBLFVBQUEsU0FBQUMsRUFBQUMsRUFBQUMsR0FNQUYsRUFBQUcsUUFBQUMsU0FBQUMsS0FHQUMsT0FBQUMsYUFBQUMsT0FDQU4sRUFBQU8sVUFDQUMsS0FBQSxTQUFBQyxHQUNBWCxFQUFBWSxNQUFBLGVBQUFELEVBQUFFLFFBSUFiLEVBQUFjLElBQUEsZUFBQSxTQUFBQyxFQUFBQyxHQUNBaEIsRUFBQWlCLFlBQUFELE9BSUFFLE9BQUEsZUFBQSxPQUFBLFNBQUFDLEdBQ0EsTUFBQSxVQUFBQyxHQUNBLE1BQUFELEdBQUFFLFlBQUFELE9BSUFGLE9BQUEsWUFBQSxXQUNBLE1BQUEsVUFBQUksRUFBQUMsR0FDQSxNQUFBRCxJQUNBQyxHQUFBQSxFQUNBRCxFQUFBRSxNQUFBRCxVQzdCQTFCLFFBQUFDLE9BQUEsT0FDQTJCLFVBQUEsaUJBQUEsUUFBQSxpQkFBQSxXQUFBLFNBQUFDLEVBQUFDLEVBQUFDLEdBQ0EsTUFBQSxVQUFBQyxFQUFBQyxFQUFBQyxHQUNBLEdBQUFDLEdBQUFE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QUEsU0FBQWpHLEdBQ0EsTUFBQWQsR0FBQVEsSUFBQSxzQkFBQXlGLFFBQUFuRixTQUFBQSxNQUdBd0gsRUFBQWQsY0FBQSxTQUFBVCxHQUNBLE1BQUEvRyxHQUFBNkMsS0FBQSxxQkFBQWtFLE9DekRBNUksUUFBQUMsT0FBQSxPQUNBc0ssS0FBQSxhQUFBLFdBQUEsVUFBQSxTQUFBbkssRUFBQStDLEVBQUFxSCxHQUVBLEdBQUFDLEdBQUEsSUFFQSxRQUFBQyxLQUVBRCxHQUFBQSxDQUdBLElBQUFqSyxHQUFBLFFBQUFnSyxFQUFBakssU0FBQUMsS0FFQW1LLEVBQUEsR0FBQUMsV0FBQXBLLEVBRUFtSyxHQUFBRSxPQUFBLGFBS0FGLEVBQUFHLFFBQUEsU0FBQUMsR0FDQWhILFFBQUFnQixJQUFBLDREQUFBMEYsRUFBQSxZQUVBdEgsRUFBQXVILEVBQUEsSUFBQUQsSUFHQUUsRUFBQUssVUFBQSxTQUFBRCxHQUVBLEdBQUFFLEdBQUFDLEtBQUFDLE1BQUFKLEVBQUEvSixNQUVBb0ssRUFBQSxNQUFBSCxFQUFBSSxNQUNBckssRUFBQWlLLEVBQUFqSyxJQUdBWixHQUFBa0wsV0FBQUYsRUFBQXBLIiwiZmlsZSI6ImFwcC5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8vVGhpcyBmaWxlIG11c3QgYmUgdGhlIGZpcnN0IGluIHRoZSBsaXN0IHRvIGJlIGNvbmNhdGVuYXRlZFxuYW5ndWxhci5tb2R1bGUoJ2FwcCcsIFsnbmdSb3V0ZScsICduZ0FuaW1hdGUnXSkiLCJhbmd1bGFyLm1vZHVsZSgnYXBwJylcblx0LmNvbnRyb2xsZXIoJ0FwcGxpY2F0aW9uQ3RybCcgLCBbXCIkc2NvcGVcIiwgXCIkcm9vdFNjb3BlXCIsIFwiVXNlclN2Y1wiLCBmdW5jdGlvbiAoJHNjb3BlLCAkcm9vdFNjb3BlLCBVc2VyU3ZjKSB7XG5cdFx0Lypcblx0XHRJZiB3ZSBoYXZlIGEgc3RvcmVkIHRva2VuLCBnZXQgdGhlIHVzZXIgaW5mb3JtYXRpb24gZnJvbSBpdFxuXHRcdGFuZCBlbWl0IHRoZSB1c2VyIGxvZ2dlZGluIG1lc3NhZ2VzIGluIG9yZGVyIHRvIGFsbG93IHRoZSBVSSB0byBcblx0XHRpbmRpY2F0ZSB0byB0aGUgdXNlciB0aGF0IHRoZXkgd2VyZSBsb2dnZWQgaW5cblx0XHQqL1xuXHRcdCRzY29wZS5iYXNlVXJsID0gbG9jYXRpb24uaG9zdDtcblxuXHRcdFxuXHRcdGlmICh3aW5kb3cubG9jYWxTdG9yYWdlLnRva2VuKSB7XG5cdFx0XHRVc2VyU3ZjLmdldFVzZXIoKVxuXHRcdFx0XHQudGhlbihmdW5jdGlvbiAocmVzcG9uc2Upe1xuXHRcdFx0XHRcdCRzY29wZS4kZW1pdCgndXNlckxvZ2dlZEluJywgcmVzcG9uc2UuZGF0YSk7XG5cdFx0XHRcdH0pXG5cdFx0fVxuXG5cdFx0JHNjb3BlLiRvbigndXNlckxvZ2dlZEluJywgZnVuY3Rpb24oZXZlbnQsIHVzZXIpIHtcblx0XHRcdCRzY29wZS5jdXJyZW50VXNlciA9IHVzZXI7XG5cdFx0fSlcblx0fV0pXG5cblx0LmZpbHRlcignb3V0cHV0X2h0bWwnLCBbXCIkc2NlXCIsIGZ1bmN0aW9uICgkc2NlKSB7XG5cdFx0cmV0dXJuIGZ1bmN0aW9uKHZhbCkge1xuXHQgICAgICAgIHJldHVybiAkc2NlLnRydXN0QXNIdG1sKHZhbCk7XG5cdCAgICB9O1xuXHR9XSlcblxuXHQuZmlsdGVyKCdzdGFydEZyb20nLCBmdW5jdGlvbigpIHtcblx0ICAgIHJldHVybiBmdW5jdGlvbihpbnB1dCwgc3RhcnQpIHtcblx0ICAgICAgICBpZihpbnB1dCkge1xuXHQgICAgICAgICAgICBzdGFydCA9ICtzdGFydDsgLy9wYXJzZSB0byBpbnRcblx0ICAgICAgICAgICAgcmV0dXJuIGlucHV0LnNsaWNlKHN0YXJ0KTtcblx0ICAgICAgICB9XG5cdCAgICAgICAgcmV0dXJuIFtdO1xuXHQgICAgfVxuXHR9KTsiLCIvKipcbiAqIENyZWF0ZWQgYnkgdG9taSBvbiAxOS8wMS8xNi5cbiAqL1xuYW5ndWxhci5tb2R1bGUoJ2FwcCcpXG4gICAgLmRpcmVjdGl2ZSgnc3RhdGljSW5jbHVkZScsIFsnJGh0dHAnLCAnJHRlbXBsYXRlQ2FjaGUnLCAnJGNvbXBpbGUnLCBmdW5jdGlvbiAoJGh0dHAsICR0ZW1wbGF0ZUNhY2hlLCAkY29tcGlsZSkge1xuICAgICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uKHNjb3BlLCBlbGVtZW50LCBhdHRycykge1xuICAgICAgICAgICAgICAgIHZhciB0ZW1wbGF0ZVBhdGggPSBhdHRycy5zdGF0aWNJbmNsdWRlO1xuICAgICAgICAgICAgICAgICRodHRwLmdldCh0ZW1wbGF0ZVBhdGgsIHsgY2FjaGU6ICR0ZW1wbGF0ZUNhY2hlIH0pLnN1Y2Nlc3MoZnVuY3Rpb24ocmVzcG9uc2UpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGNvbnRlbnRzID0gZWxlbWVudC5odG1sKHJlc3BvbnNlKS5jb250ZW50cygpO1xuICAgICAgICAgICAgICAgICAgICAkY29tcGlsZShjb250ZW50cykoc2NvcGUpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfTtcbiAgICB9XSkiLCJhbmd1bGFyLm1vZHVsZSgnYXBwJylcblx0LmNvbnRyb2xsZXIoJ0xvZ2luQ3RybCcgLCBbXCIkc2NvcGVcIiAsIFwiVXNlclN2Y1wiICwgZnVuY3Rpb24gKCRzY29wZSwgVXNlclN2Yykge1xuXHRcdCRzY29wZS5sb2dpbiA9IGZ1bmN0aW9uICh1c2VybmFtZSwgcGFzc3dvcmQpIHtcblx0XHRcdFVzZXJTdmMubG9naW4odXNlcm5hbWUsIHBhc3N3b3JkKVxuXHRcdFx0XHQudGhlbihmdW5jdGlvbiAocmVzcG9uc2Upe1xuXHRcdFx0XHRcdCRzY29wZS4kZW1pdCgndXNlckxvZ2dlZEluJywgcmVzcG9uc2UuZGF0YSk7XG5cdFx0XHRcdFx0d2luZG93LmxvY2F0aW9uLmhyZWYgPSAnIy8nXG5cdFx0XHRcdH0sXG5cdFx0XHRcdGZ1bmN0aW9uKGVycm9yKXtcblx0XHRcdFx0ICAkc2NvcGUubG9naW5WYWxpZGF0aW9uID0gJ0luY29ycmVjdCB1c2VybmFtZSAmIHBhc3N3b3JkIGNvbWJpbmF0aW9uJztcblx0XHRcdFx0fSlcblxuXHRcdH1cblxuXHRcdCRzY29wZS5sb2dvdXQgPSBmdW5jdGlvbiAoKSB7XG5cdFx0XHRVc2VyU3ZjLmxvZ291dCgpXG5cdFx0fVxuXHR9XSkiLCJhbmd1bGFyLm1vZHVsZSgnYXBwJylcblx0LmNvbnRyb2xsZXIoJ1Bvc3RzQ3RybCcsIFtcIiRzY29wZVwiICwgXCIkaHR0cFwiLCBcIlBvc3RzU2VydmljZVwiLCBcImZpbHRlckZpbHRlclwiLCBcIlVzZXJTdmNcIiwgXCIkdGltZW91dFwiLCBmdW5jdGlvbiAoJHNjb3BlLCAkaHR0cCwgUG9zdHNTZXJ2aWNlLCBmaWx0ZXJGaWx0ZXIsIFVzZXJTdmMsICR0aW1lb3V0KSB7XG5cdFx0JHNjb3BlLmJhc2VVcmwgPSBsb2NhdGlvbi5ob3N0O1xuXHRcdCRzY29wZS5ib2R5TGVuZ3RoTGltaXQgPSAyNTA7XG5cdFx0JHNjb3BlLnBvc3RUYWdzQXJyYXkgPSBbXTtcblx0XHQkc2NvcGUuY2tMb2FkZWQgPSBmYWxzZTtcblxuXHRcdCRzY29wZS5wb3N0cyA9IFtdO1xuXHRcdCRzY29wZS5hZGRQb3N0ID0gZnVuY3Rpb24gKCkge1xuXHRcdFx0dHJ5IHtcblx0XHRcdFx0dmFyIHBvc3RDb250ZW50ID0gQ0tFRElUT1IuaW5zdGFuY2VzLmVkaXRvcjEuZ2V0RGF0YSgpO1xuXHRcdFx0fVxuXHRcdFx0Y2F0Y2goZXJyKSB7XG5cdFx0XHRcdC8vIGNrZWRpdG9yIGlzIG5vdCBsb2FkZWRcblx0XHRcdFx0Y29uc29sZS5lcnJvcihcIkNLRURJVE9SIGhhcyBub3QgYmVlbiBsb2FkZWRcIik7XG5cdFx0XHR9XG5cdFx0XHRpZiAoIXBvc3RDb250ZW50KSB7XG5cdFx0XHRcdHZhciBwb3N0Q29udGVudCA9ICRzY29wZS5wb3N0Q29udGVudDtcblx0XHRcdH1cblxuXHRcdFx0dmFyIGRhdGVfc2x1ZyA9ICRzY29wZS51cmxEYXRlKCk7XG5cdFx0XHR2YXIgdGl0bGVfc2x1ZyA9ICRzY29wZS5zbHVnaWZ5KCRzY29wZS5wb3N0VGl0bGUpO1xuXG5cdFx0XHR2YXIgc2x1ZyA9IGRhdGVfc2x1ZyArIHRpdGxlX3NsdWc7XG5cblx0XHRcdGlmIChwb3N0Q29udGVudCkge1xuXHRcdFx0XHRQb3N0c1NlcnZpY2Uuc2VuZCh7XG5cdFx0XHRcdFx0Ym9keTogcG9zdENvbnRlbnQsXG5cdFx0XHRcdFx0dGl0bGU6ICRzY29wZS5wb3N0VGl0bGUsXG5cdFx0XHRcdFx0dGFnczogJHNjb3BlLnBvc3RUYWdzQXJyYXksXG5cdFx0XHRcdFx0c2x1Zzogc2x1Z1xuXHRcdFx0XHR9KVxuXHRcdFx0XHQuc3VjY2VzcyhmdW5jdGlvbiAocG9zdCkge1xuXHRcdFx0XHRcdC8qXG5cdFx0XHRcdFx0Ly9SZW1vdmVkIGFzIHdlYnNvY2tldCBicm9hZGNhc3Qgd291bGQgY2F1c2UgdGhlIHBvc3QgdG8gYXBwZWFyIGR1cGxpY2F0ZWQgb24gdGhlIGJyb3dzZXIgdGhhdCBpdCB3YXMgcG9zdGVkIGZyb20gXG5cdFx0XHRcdFx0Ly9hcyBib3RoIG9mIHRoZSBmdW5jdGlvbnMgd291bGQgZ2V0IGV4ZWN1dGVkIGJlY2F1c2UgdGhlIGNsaWVudCB3aG8gc2VuZHMgdGhlIHBvc3Qgd291bGQgc3RpbGwgcmVjaWV2ZSB0aGUgd2Vic29ja2V0cyBicm9hZGNhc3QgYmFjayBmcm9tIHRoZSBzZXJ2ZXIgIFxuXHRcdFx0XHRcdCovXG5cdFx0XHRcdFx0JHNjb3BlLnBvc3RCb2R5ID0gbnVsbDtcblx0XHRcdFx0XHRDS0VESVRPUi5pbnN0YW5jZXMuZWRpdG9yMS5zZXREYXRhKCcnKTtcblx0XHRcdFx0XHQkc2NvcGUucG9zdFRpdGxlID0gbnVsbDtcblx0XHRcdFx0fSlcblx0XHRcdH1cblx0XHR9O1xuXG5cdFx0JHNjb3BlLiRvbignJGluY2x1ZGVDb250ZW50TG9hZGVkJywgZnVuY3Rpb24gKCkge1xuXHRcdFx0JHNjb3BlLmluaXRfY2tlZGl0b3IoKTtcblx0XHR9KTtcblxuXHRcdCRzY29wZS5pbml0X2NrZWRpdG9yID0gZnVuY3Rpb24gKCkge1xuXHRcdFx0JHNjb3BlLmNrTG9hZGVkID0gdHJ1ZTtcblx0XHRcdHRyeSB7XG5cdFx0XHRcdHZhciBlZGl0b3IgPSBDS0VESVRPUi5yZXBsYWNlKCdlZGl0b3IxJyk7XG5cdFx0XHR9IGNhdGNoIChlcnIpIHtcblx0XHRcdFx0JHNjb3BlLmNrTG9hZGVkID0gZmFsc2U7XG5cdFx0XHRcdGNvbnNvbGUubG9nKFwiRXJyb3I6IFwiICsgZXJyKTtcblx0XHRcdH1cblx0XHRcdC8vaWYgKHR5cGVvZiBlZGl0b3IgPT09ICd1bmRlZmluZWQnKSB7XG5cdFx0XHQvL1x0JHRpbWVvdXQoZnVuY3Rpb24oKSB7XG5cdFx0XHQvL1x0XHQkc2NvcGUuaW5pdF9ja2VkaXRvcigpO1xuXHRcdFx0Ly9cdH0sIDEwMDApXG5cdFx0XHQvL31cblx0XHR9O1xuXG5cdFx0JHNjb3BlLiRvbignd3M6bmV3X3Bvc3QnLCBmdW5jdGlvbihfLCBwb3N0KSB7XG5cdFx0XHRwb3N0ID0gcG9zdFswXTtcblx0XHRcdCRzY29wZS4kYXBwbHkoZnVuY3Rpb24gKCkge1xuXHRcdFx0XHQkc2NvcGUucG9zdHMudW5zaGlmdChwb3N0KTtcblx0XHRcdFx0JHNjb3BlLnBhZ2luYXRlKCk7XG5cdFx0XHR9KVxuXHRcdH0pO1xuXG5cdFx0JHNjb3BlLiRvbignJHZpZXdDb250ZW50TG9hZGVkJywgZnVuY3Rpb24oKXtcblx0XHRcdC8vdGhlIHBhZ2UgaXMgcmVhZHlcblx0XHR9KTtcblxuXHRcdCRzY29wZS5jdXJyZW50UGFnZSA9IDE7XG5cdFx0JHNjb3BlLnBvc3RzUGVyUGFnZSA9IDU7XG5cblx0XHQkc2NvcGUucHJldlBhZ2UgPSBmdW5jdGlvbiAoKSB7XG5cdCAgICAgICAgaWYgKCRzY29wZS5jdXJyZW50UGFnZSA+IDEpIHtcblx0ICAgICAgICAgICAgJHNjb3BlLmN1cnJlbnRQYWdlLS07XG5cdCAgICAgICAgfVxuXHQgICAgfTtcbiAgICBcblx0ICAgICRzY29wZS5uZXh0UGFnZSA9IGZ1bmN0aW9uICgpIHtcblx0ICAgICAgICBpZiAoJHNjb3BlLmN1cnJlbnRQYWdlIDwgJHNjb3BlLnBvc3RzLmxlbmd0aC8kc2NvcGUucG9zdHNQZXJQYWdlKSB7XG5cdCAgICAgICAgICAgICRzY29wZS5jdXJyZW50UGFnZSsrO1xuXHQgICAgICAgIH1cblx0ICAgIH07XG5cdCAgICBcblx0ICAgICRzY29wZS5zZXRQYWdlID0gZnVuY3Rpb24gKHBhZ2VfbnVtYmVyKSB7XG5cdCAgICAgICAgJHNjb3BlLmN1cnJlbnRQYWdlID0gcGFnZV9udW1iZXI7XG5cdCAgICB9O1xuXG5cdCAgICAvL1RoaXMgd2F5IEkgY2FuIGRvOiAgXCI8bGkgbmctcmVwZWF0PVwibiBpbiByYW5nZShwYWdlcykgdHJhY2sgYnkgJGluZGV4XCI+XCIgYW5kIHNvIEkgY2FuIGRpc3BsYXkgYXMgbWFueSBpdGVtcyBhcyB0aGUgdmFsdWUgb2YgYSBudW1iZXIgYXMgdGhpcyByZXR1cm5zIGFuIGFycmF5IG9mIHRoYXQgbGVuZ2h0XG5cdCAgICAkc2NvcGUucmFuZ2UgPSBmdW5jdGlvbihuKSB7XG4gICAgICAgIFx0cmV0dXJuIG5ldyBBcnJheShuKTtcbiAgICBcdH07XG5cdCAgICBcblx0ICAgIC8vd2F0Y2ggdG8gc2VlIGlmIHNlYXJjaGluZyBhbmQgcmVwYWdpbmF0ZSBpZiB3ZSBhcmVcblx0ICAgIC8vdHJ1ZSBhdCB0aGUgZW5kICBtYWdpY2FsbHkgbWFrZXMgaXQgc28gdGhhdCBhcyBlYWNoIGV4dHJhIGxldHRlciBpcyBhZGRlZCB0byB0aGUgc2VhcmNoIHdlIGNhbiByZXBhZ2luYXRlXG5cdCAgICAvL3dpdGhvdXQgdGhlICd0cnVlJyBpdCBvbmx5IGRpZCAgdGhhdFxuXHQgICAgJHNjb3BlLiR3YXRjaCgnc2VhcmNoJywgZnVuY3Rpb24odGVybSkge1xuXHQgICAgICAgICRzY29wZS5maWx0ZXJlZFBvc3RzID0gZmlsdGVyRmlsdGVyKCRzY29wZS5wb3N0cywgdGVybSk7XG5cdCAgICAgICAgJHNjb3BlLnBhZ2luYXRlKCRzY29wZS5maWx0ZXJlZFBvc3RzLmxlbmd0aCk7XG5cdCAgICB9LCB0cnVlKTtcblxuXG5cdCAgICAkc2NvcGUucGFnaW5hdGUgPSBmdW5jdGlvbihudW1iZXJfb2ZfaXRlbXMpe1xuXHQgICAgXHRpZiAobnVtYmVyX29mX2l0ZW1zID4gMCkge1xuXHQgICAgICAgIFx0JHNjb3BlLm51bWJlck9mUGFnZXMgPSBNYXRoLmNlaWwobnVtYmVyX29mX2l0ZW1zLyRzY29wZS5wb3N0c1BlclBhZ2UpO1xuXHQgICAgICAgIH1cblx0ICAgICAgICBlbHNlIHtcblx0ICAgICAgICBcdCRzY29wZS5udW1iZXJPZlBhZ2VzID0gTWF0aC5jZWlsKCRzY29wZS5wb3N0cy5sZW5ndGgvJHNjb3BlLnBvc3RzUGVyUGFnZSk7XG5cdCAgICAgICAgfVxuXHQgICAgfTtcblxuXHQgICAgJHNjb3BlLnVybERhdGUgPSBmdW5jdGlvbih0aW1lKSB7XG5cdFx0XHRpZiAodGltZSA9PT0gdW5kZWZpbmVkKSB7XG5cdFx0XHRcdHZhciBkYXRlID0gbmV3IERhdGUoKTtcblx0XHRcdH1cblx0XHRcdGVsc2Uge1xuXHRcdFx0XHR2YXIgZGF0ZSA9IG5ldyBEYXRlKHRpbWUpO1xuXHRcdFx0fVxuXHRcdCAgICB2YXIgZGF5ID0gZGF0ZS5nZXREYXRlKCk7XG5cdFx0ICAgIHZhciBtb250aCA9IGRhdGUuZ2V0TW9udGgoKSsxOyAvLysxIGJlY2F1c2UgbW9udGhzIGFyZSAwIGluZGV4ZWRcblx0XHQgICAgdmFyIHllYXIgPSBkYXRlLmdldEZ1bGxZZWFyKCk7XG5cbiAgICAgICAgICAgIHJldHVybiBTdHJpbmcoeWVhcikgKyAnLycgKyBTdHJpbmcobW9udGgpICsgJy8nICsgU3RyaW5nKGRheSkgKyAnLycgO1xuICAgICAgICB9O1xuXG5cdFx0JHNjb3BlLiR3YXRjaCgncG9zdFRpdGxlJywgZnVuY3Rpb24odGl0bGUpIHtcblx0XHRcdGlmICh0aXRsZSkge1xuXHRcdFx0XHQkc2NvcGUuZ2VuZXJhdGVTbHVnKHRpdGxlKTtcblx0XHRcdH1cblx0XHR9LCB0cnVlKTtcblxuXHRcdCRzY29wZS5nZW5lcmF0ZVNsdWcgPSBmdW5jdGlvbiAoKSB7XG5cdFx0XHQkc2NvcGUuc2x1ZyA9ICRzY29wZS51cmxEYXRlKCkgKyAkc2NvcGUuc2x1Z2lmeSgkc2NvcGUucG9zdFRpdGxlKTtcblx0XHR9O1xuXG5cdCAgICAkc2NvcGUuc2x1Z2lmeSA9IGZ1bmN0aW9uKHN0cmluZykge1xuXHQgICAgXHR2YXIgc2x1ZyA9ICBzdHJpbmcudG9Mb3dlckNhc2UoKTtcblx0ICAgIFx0c2x1ZyA9IHNsdWcucmVwbGFjZSgvXFxzKy9nLFwiLVwiKTtcblx0ICAgIFx0c2x1ZyA9IHNsdWcucmVwbGFjZSgvXFw/L2csIFwiXCIpO1xuXHQgICAgXHRzbHVnID0gc2x1Zy5yZXBsYWNlKC9cXCYvZywgXCJcIik7XG5cdCAgICBcdHNsdWcgPSBzbHVnLnJlcGxhY2UoL1xcPS9nLCBcIlwiKTtcblx0ICAgIFx0cmV0dXJuIHNsdWc7XG5cdCAgICB9O1xuXG5cdFx0JHNjb3BlLmFkZFRhZyA9IGZ1bmN0aW9uKHRhZykge1xuXHRcdFx0Ly9jb25zb2xlLmxvZyh0YWcpO1xuXHRcdFx0JHNjb3BlLnBvc3RUYWdzQXJyYXkucHVzaCh0YWcpO1xuXHRcdFx0JHNjb3BlLnBvc3RUYWcgPSAnJztcblx0XHR9O1xuXG5cdFx0JHNjb3BlLnJlbW92ZVRhZyA9IGZ1bmN0aW9uKHRhZ0luZGV4KSB7XG5cdFx0XHQkc2NvcGUucG9zdFRhZ3NBcnJheS5zcGxpY2UodGFnSW5kZXgsIDEpO1xuXHRcdH07XG5cblx0UG9zdHNTZXJ2aWNlLmdldCgpXG5cdFx0LnN1Y2Nlc3MoZnVuY3Rpb24gKHBvc3RzKSB7XG5cdFx0XHQkc2NvcGUucG9zdHMgPSBwb3N0cztcblx0XHRcdC8vY29uc29sZS5sb2cocG9zdHMpOyAvL0xvZyBhbGwgdGhlIHBvc3RzIHJlY2lldmVkIGZyb20gdGhlIHNlcnZlclxuXHRcdFx0JHNjb3BlLnBhZ2luYXRlKCRzY29wZS5wb3N0cy5sZW5ndGgpO1xuXHRcdH0pXG5cblx0fV0pIiwiYW5ndWxhci5tb2R1bGUoJ2FwcCcpXG5cdC5zZXJ2aWNlKCdQb3N0c1NlcnZpY2UnLCBbXCIkaHR0cFwiICwgZnVuY3Rpb24gKCRodHRwKSB7XG5cdFx0dGhpcy5nZXQgPSBmdW5jdGlvbiAoKSB7XG5cdFx0XHRyZXR1cm4gJGh0dHAuZ2V0KCcvYXBpL3Bvc3RzJyk7XG5cdFx0fVxuXHRcdHRoaXMuc2VuZCA9IGZ1bmN0aW9uIChwb3N0KSB7XG5cdFx0XHRyZXR1cm4gJGh0dHAucG9zdCgnL2FwaS9wb3N0cycsIHBvc3QpO1xuXHRcdH1cblx0XHR0aGlzLnJlbW92ZUl0ZW0gPSBmdW5jdGlvbiAocGFyYW1ldGVycykge1xuXHRcdFx0cmV0dXJuICRodHRwLnBvc3QoJy9hcGkvcG9zdHMvcmVtb3ZlSXRlbScsIHsgcGFyYW1zOiB7cG9zdF9pZDogcGFyYW1ldGVycy5wb3N0X2lkfSB9KTtcblx0XHR9XG5cdFx0dGhpcy5zaW5nbGVfc2x1ZyA9IGZ1bmN0aW9uIChwYXJhbWV0ZXJzKSB7XG5cdFx0XHRyZXR1cm4gJGh0dHAuZ2V0KCcvYXBpL3Bvc3RzJywgeyBwYXJhbXM6IHtwb3N0X3NsdWc6IHBhcmFtZXRlcnMuc2x1Z30gfSApO1xuXHRcdH1cblx0XHR0aGlzLnNpbmdsZV9pZCA9IGZ1bmN0aW9uIChwYXJhbWV0ZXJzKSB7XG5cdFx0XHRyZXR1cm4gJGh0dHAuZ2V0KCcvYXBpL3Bvc3RzJywgeyBwYXJhbXM6IHtwb3N0X2lkOiBwYXJhbWV0ZXJzLmlkfSB9ICk7XG5cdFx0fVxuXHRcdHRoaXMudXNlcl9wb3N0cyA9IGZ1bmN0aW9uIChwYXJhbWV0ZXJzKSB7XG5cdFx0XHRyZXR1cm4gJGh0dHAuZ2V0KCcvYXBpL3Bvc3RzJywgeyBwYXJhbXM6IHtfYXV0aG9yOiBwYXJhbWV0ZXJzLl9hdXRob3J9IH0gKTtcblx0XHR9XG5cdH1dKSIsImFuZ3VsYXIubW9kdWxlKCdhcHAnKVxuXHQuY29udHJvbGxlcignUHJvZmlsZUN0cmwnLCBbXCIkc2NvcGVcIiAsIFwiJGh0dHBcIiwgXCJVc2VyU3ZjXCIsIFwiUG9zdHNTZXJ2aWNlXCIgLCBcIiRyb3V0ZVBhcmFtc1wiLCBcIiRyb3V0ZVwiLCBcIiRsb2NhdGlvblwiICwgZnVuY3Rpb24gKCRzY29wZSwgJGh0dHAsIFVzZXJTdmMsIFBvc3RzU2VydmljZSwgJHJvdXRlUGFyYW1zLCAkcm91dGUsICRsb2NhdGlvbikge1xuXG5cblx0XHQvKi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblx0XHQvIEdldCB1c2VyIHBlcm1pc3Npb25zXG5cdFx0Ly0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qL1xuXHRcdCRzY29wZS5lZGl0UGVybWlzc2lvbiA9IGZ1bmN0aW9uKHBlcm1pc3Npb25fbGV2ZWwpIHtcblx0XHQgIFx0VXNlclN2Yy5hdXRob3JpemF0aW9uKClcblx0XHRcdFx0LnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKXtcblx0XHRcdFx0XHQkc2NvcGU9KHJlc3BvbnNlKTtcblx0XHRcdFx0fSlcblx0XHR9XG5cdFx0LyotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cdFx0LyBFbmQgdXNlciBwZXJtaXNzaW9uc1xuXHRcdC8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi9cblxuXG5cdFx0JHNjb3BlLmJhc2VVcmwgPSBsb2NhdGlvbi5ob3N0O1xuXHRcdHZhciB1c2VybmFtZSA9ICRyb3V0ZVBhcmFtcy51c2VybmFtZTtcblx0XHQkc2NvcGUubmV3ICA9IHt9O1xuXG5cdFx0VXNlclN2Yy5wcm9maWxlKHVzZXJuYW1lKVxuXHRcdFx0LnN1Y2Nlc3MoZnVuY3Rpb24gKHVzZXJfcHJvZmlsZSkge1xuXHRcdFx0XHQkc2NvcGUudXNlcl9wcm9maWxlID0gdXNlcl9wcm9maWxlO1xuXHRcdFx0XHRQb3N0c1NlcnZpY2UudXNlcl9wb3N0cyAoe1xuXHRcdFx0XHRcdF9hdXRob3I6ICRzY29wZS51c2VyX3Byb2ZpbGUuX2lkXG5cdFx0XHRcdH0pXG5cdFx0XHRcdFx0LnN1Y2Nlc3MoZnVuY3Rpb24gKHVzZXJfcG9zdHMpIHtcblx0XHRcdFx0XHRcdCRzY29wZS51c2VyX3Bvc3RzID0gdXNlcl9wb3N0cztcblx0XHRcdFx0XHRcdCRzY29wZS5wYWdpbmF0ZSgkc2NvcGUudXNlcl9wb3N0cy5sZW5ndGgpO1xuXHRcdFx0XHRcdH0pXG5cdFx0XHR9KVxuXG5cdFx0LyotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cdFx0LyBDaGVjayBjdXJyZW50bHkgbG9nZ2VkIGluIHVzZXIgXG5cdFx0Ly0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSovXG5cblx0XHQkc2NvcGUuY2hlY2tMb2dpbiA9IGZ1bmN0aW9uKCkge1xuXHRcdFx0Ly9pcyBhbnlvbmUgbG9nZ2VkIGluXG5cdFx0ICBcdGlmICh3aW5kb3cubG9jYWxTdG9yYWdlLnRva2VuKSB7XG5cdFx0XHQgIFx0Ly9nZXQgY3VycmVudCB1c2VyXG5cdFx0XHQgIFx0VXNlclN2Yy5nZXRVc2VyKClcblx0XHRcdFx0XHQudGhlbihmdW5jdGlvbiAocmVzcG9uc2Upe1xuXHRcdFx0XHRcdFx0JHNjb3BlLmN1cnJlbnRVc2VyID0gcmVzcG9uc2UuZGF0YTtcblx0XHRcdFx0XHRcdFx0Ly9pcyB0aGUgdXNlciB0aGUgc2FtZSBhcyB0aGUgdXNlciB3aG8ncyBwYWdlIHRoaXMgaXMgb3IgdGhleSBoYXZlIGEgaGlnaGVyIHBlcm1pc3Npb24gbGV2ZWwgdGhlbiBsZXQgdGhlbSBlZGl0IHRoZSBwYWdlXG5cdFx0XHRcdFx0XHRcdGlmICgkc2NvcGUudXNlcl9wcm9maWxlLl9pZCA9PSAkc2NvcGUuY3VycmVudFVzZXIuX2lkIHx8ICRzY29wZS5lZGl0UGVybWlzc2lvbigkc2NvcGUuY3VycmVudFVzZXIucGVybWlzc2lvbl9sZXZlbCkgKSB7XG5cdFx0XHRcdFx0XHRcdFx0JHNjb3BlLmNhbkVkaXQgPSB0cnVlO1xuXHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fSlcblx0XHRcdH1cblx0XHR9O1xuXG5cdFx0LyotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cdFx0LyBFbmQgdXNlciBjaGVjayBcblx0XHQvLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi9cblxuXHRcdCRzY29wZS5jdXJyZW50VXNlciA9IFtdO1xuXG5cdFx0JHNjb3BlLmNoZWNrTG9naW4oKTtcblxuXHRcdCRzY29wZS4kb24oJyR2aWV3Q29udGVudExvYWRlZCcsIGZ1bmN0aW9uKCl7XG5cdFx0XHQvL3RoZSBwYWdlIGlzIHJlYWR5XG5cdFx0fSk7XG5cblx0XHQvKi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblx0XHQvIFBhZ2luYXRpb24gXG5cdFx0Ly0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSovXG5cblx0XHQkc2NvcGUudXNlcl9wb3N0cyA9IFtdO1xuXG5cdFx0JHNjb3BlLmN1cnJlbnRQYWdlID0gMTtcblx0XHQkc2NvcGUucG9zdHNQZXJQYWdlID0gNTtcblxuXHRcdCRzY29wZS5wcmV2UGFnZSA9IGZ1bmN0aW9uICgpIHtcblx0ICAgICAgICBpZiAoJHNjb3BlLmN1cnJlbnRQYWdlID4gMSkge1xuXHQgICAgICAgICAgICAkc2NvcGUuY3VycmVudFBhZ2UtLTtcblx0ICAgICAgICB9XG5cdCAgICB9O1xuICAgIFxuXHQgICAgJHNjb3BlLm5leHRQYWdlID0gZnVuY3Rpb24gKCkge1xuXHQgICAgICAgIGlmICgkc2NvcGUuY3VycmVudFBhZ2UgPCAkc2NvcGUudXNlcl9wb3N0cy5sZW5ndGgvJHNjb3BlLnBvc3RzUGVyUGFnZSkge1xuXHQgICAgICAgICAgICAkc2NvcGUuY3VycmVudFBhZ2UrKztcblx0ICAgICAgICB9XG5cdCAgICB9O1xuXHQgICAgXG5cdCAgICAkc2NvcGUuc2V0UGFnZSA9IGZ1bmN0aW9uIChwYWdlX251bWJlcikge1xuXHQgICAgICAgICRzY29wZS5jdXJyZW50UGFnZSA9IHBhZ2VfbnVtYmVyO1xuXHQgICAgfTtcblxuXHQgICAgLy9UaGlzIHdheSBJIGNhbiBkbzogIFwiPGxpIG5nLXJlcGVhdD1cIm4gaW4gcmFuZ2UocGFnZXMpIHRyYWNrIGJ5ICRpbmRleFwiPlwiIGFuZCBzbyBJIGNhbiBkaXNwbGF5IGFzIG1hbnkgaXRlbXMgYXMgdGhlIHZhbHVlIG9mIGEgbnVtYmVyIGFzIHRoaXMgcmV0dXJucyBhbiBhcnJheSBvZiB0aGF0IGxlbmdodFxuXHQgICAgJHNjb3BlLnJhbmdlID0gZnVuY3Rpb24obikge1xuICAgICAgICBcdHJldHVybiBuZXcgQXJyYXkobik7XG4gICAgXHR9O1xuXHQgICAgXG5cblx0XHQkc2NvcGUucGFnaW5hdGUgPSBmdW5jdGlvbihudW1iZXJfb2ZfaXRlbXMpe1xuXHQgICAgXHRpZiAobnVtYmVyX29mX2l0ZW1zID4gMCkge1xuXHQgICAgICAgIFx0JHNjb3BlLm51bWJlck9mUGFnZXMgPSBNYXRoLmNlaWwobnVtYmVyX29mX2l0ZW1zLyRzY29wZS5wb3N0c1BlclBhZ2UpO1xuXHQgICAgICAgIH1cblx0ICAgICAgICBlbHNlIHtcblx0ICAgICAgICBcdCRzY29wZS5udW1iZXJPZlBhZ2VzID0gTWF0aC5jZWlsKCRzY29wZS51c2VyX3Bvc3RzLmxlbmd0aC8kc2NvcGUucG9zdHNQZXJQYWdlKTtcblx0ICAgICAgICB9XG5cdCAgICB9O1xuXG5cblxuXHQgICAgLy9UaGlzIHdheSBJIGNhbiBkbzogIFwiPGxpIG5nLXJlcGVhdD1cIm4gaW4gcmFuZ2UocGFnZXMpIHRyYWNrIGJ5ICRpbmRleFwiPlwiIGFuZCBzbyBJIGNhbiBkaXNwbGF5IGFzIG1hbnkgaXRlbXMgYXMgdGhlIHZhbHVlIG9mIGEgbnVtYmVyIGFzIHRoaXMgcmV0dXJucyBhbiBhcnJheSBvZiB0aGF0IGxlbmdodFxuXHQgICAgJHNjb3BlLnJhbmdlID0gZnVuY3Rpb24obikge1xuICAgICAgICBcdHJldHVybiBuZXcgQXJyYXkobik7XG4gICAgXHR9O1xuXG5cdFx0LyotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cdFx0LyBFbmQgUGFnaW5hdGlvbiBcblx0XHQvLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSovXG5cblx0ICBcdFVzZXJTdmMuYXV0aG9yaXphdGlvbignMTAnKVxuXHRcdFx0LnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKXtcblx0XHRcdFx0Y29uc29sZS5sb2cocmVzcG9uc2UpO1xuXHRcdFx0fSlcblxuXHRcdC8qLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXHRcdC8gUHJvZmlsZSBlZGl0IG9wdGlvbnMgXG5cdFx0Ly0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qL1xuXG5cdFx0JHNjb3BlLnNhdmVQcm9maWxlID0gZnVuY3Rpb24gKCkge1xuXG5cdFx0XHQvL2dldCB0aGUgaWQgb2YgdGhlIGN1cnJlbnRseSBsb2dnZWQgaW4gdXNlcidzIElELiBTbyB3ZSBjYW4gdXNlIHRoaXMgdG8gZWRpdCB0aGUgdXNlci4gdG9kbzogY2hhbmdlIHRoaXMgc28gdGhlIHN1cGVydXNlcnMgY2FuIGNob29zZSB3aG8gaXMgZWRpdGVkIHdoZW4gdGhleSB2aXNpdCB0aGUgcGFnZVxuXHRcdFx0dmFyIHByb2ZpbGVfZGV0YWlscyA9IHtcblx0XHRcdFx0X2lkIDogJHNjb3BlLnVzZXJfcHJvZmlsZS5faWRcblx0XHRcdH07XG5cblx0XHRcdC8vaXRlcmF0ZSB0aHJvdWdoIHRoZSBuZXcgZGV0YWlscywgaWYgdGhleSBhcmUgbm90IGVtcHR5IHRoZW4gYWRkIHRoZW0gdG8gdGhlIHByb2ZpbGUgZGV0YWlscyBvYmplY3Rcblx0XHRcdGZvciAodmFyIGtleSBpbiAkc2NvcGUubmV3KSB7XG5cdFx0XHQgIGlmICgkc2NvcGUubmV3Lmhhc093blByb3BlcnR5KGtleSkpIHtcblx0XHRcdCAgICAvL2FsZXJ0KGtleSArIFwiIC0+IFwiICsgJHNjb3BlLm5ld1trZXldKTtcblx0XHRcdCAgICBpZiAoJHNjb3BlLm5ld1trZXldICE9ICcnKSB7XG5cdFx0XHQgICAgXHRwcm9maWxlX2RldGFpbHNba2V5XSA9ICRzY29wZS5uZXdba2V5XTtcblx0XHRcdCAgICB9XG5cdFx0XHQgIH1cblx0XHRcdH1cblxuXHRcdFx0Ly9zZW5kIHRoaXMgcHJvZmlsZSBkZXRhaWxzIG9iZWplY3QgdG8gdGhlIHVzZXIgc2VydmljZS4gVGhpcyB0aGVuIHVwZGF0ZWQgb3IgYWRkcyBhbGwgZGV0YWlsIGluIHRoaXMgdG8gdGhlIHVzZXIgd2hvJ3MgSUQgd2FzIHNlbGVjdGVkIGVhcmxpZXJcblx0XHRcdFVzZXJTdmMucHJvZmlsZVVwZGF0ZShwcm9maWxlX2RldGFpbHMpXG5cdFx0XHRcdC5zdWNjZXNzKGZ1bmN0aW9uICh1c2VyKSB7XG5cdFx0XHRcdFx0Ly9jb25zb2xlLmxvZyh1c2VyKTtcblx0XHRcdFx0XHQvL1RoZSB1c2VybmFtZSBpcyB1c2VkIGFzIHBhcnQgb2YgdGhlIHVzZXJzIGxvZ2luIHRva2VuLCBzbyBpZiB0aGUgdXNlcm5hbWUgY2hhbmdlcyB0aGUgdG9rZW4gaXMgbm8gbG9uZ2VyIHZhbGlkICh0aGlzIGlzIG5lZWRlZCBmb3Igc2VjdXJpdHkgcmVhc29ucylcblx0XHRcdFx0XHQvL3RoZXJlZm9yZSBjaGFuZ2luZyBhIHVzZXJuYW1lIHdpbGwgZWZmZWN0aXZlbHkgbG9nIHNvbWVvbmUgb3V0LiBcblx0XHRcdFx0XHQvL1NvIHdlIG5lZWQgdG8gY2hlY2sgaWYgdGhlaXIgdXNlcm5hbWUgd2FzIGNoYW5nZWQsIGFuZCBpZiBpdCB3YXMgdGhlbiBzZW5kIHRoZW0gdG8gdGhlIGxvZ2luIHBhZ2Ugc28gdGhleSBjYW4gbG9nIGludG8gdGhleSBhY2NvdW50IGFnaWFuIGFuZCBnZXQgYSBuZXcgdG9rZW5cblx0XHRcdFx0XHRpZiAodXNlci51c2VybmFtZSAhPSAkc2NvcGUudXNlcl9wcm9maWxlLnVzZXJuYW1lKSB7XG5cdFx0XHRcdFx0XHQkc2NvcGUucmV0dXJuTWVzc2FnZSA9IFwiWW91ciB1c2VybmFtZSB3YXMgY2hhbmdlZCBzbyB5b3UgbXVzdCBsb2cgaW4gYWdhaW5cIjtcblx0XHRcdFx0XHRcdHNldFRpbWVvdXQoZnVuY3Rpb24oKXsgXG5cdFx0XHRcdFx0XHRcdHdpbmRvdy5sb2NhdGlvbi5ocmVmPSAnLyMvbG9naW4nO1xuXHRcdFx0XHRcdFx0fSwgMTUwMCk7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHRcdGVsc2Uge1xuXHRcdFx0XHRcdFx0JHNjb3BlLnJldHVybk1lc3NhZ2UgPSBcIkRldGFpbHMgdXBkYXRlZCBzdWNjZXNzZnVsbHlcIjtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XG5cdFx0XHRcdH0pXG5cdFx0fVxuXG5cdFx0LyotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cdFx0LyBFbmQgcHJvZmlsZSBlZGl0IG9wdGlvbnMgXG5cdFx0Ly0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qL1xuXHR9XSkiLCJhbmd1bGFyLm1vZHVsZSgnYXBwJylcblx0LmNvbnRyb2xsZXIoJ1JlZ2lzdGVyQ3RybCcgLCBbXCIkc2NvcGVcIiAsIFwiVXNlclN2Y1wiICwgZnVuY3Rpb24gKCRzY29wZSwgVXNlclN2Yykge1xuXHRcdCRzY29wZS5yZWdpc3RlciA9IGZ1bmN0aW9uICh1c2VybmFtZSwgcGFzc3dvcmQsIHBhc3N3b3JkX2NvbmZpcm0pIHtcblx0XHRcdGlmIChwYXNzd29yZCAhPSBwYXNzd29yZF9jb25maXJtKSB7XG5cdFx0XHRcdCRzY29wZS52YWxpZGF0aW9uTWVzc2FnZSA9ICdZb3VyIHBhc3N3b3JkcyBkaWQgbm90IG1hdGNoLic7XG5cdFx0XHRcdHJldHVybjtcblx0XHRcdH1cblx0XHRcdFVzZXJTdmMucmVnaXN0ZXIodXNlcm5hbWUsIHBhc3N3b3JkKVxuXHRcdH1cblx0fV0pIiwiYW5ndWxhci5tb2R1bGUoJ2FwcCcpXG5cdC5jb25maWcoW1wiJHJvdXRlUHJvdmlkZXJcIiAsZnVuY3Rpb24gKCRyb3V0ZVByb3ZpZGVyKSB7XG5cdFx0JHJvdXRlUHJvdmlkZXJcblx0XHRcdC53aGVuKCcvJyAsIHtjb250cm9sbGVyOiAnUG9zdHNDdHJsJywgdGVtcGxhdGVVcmw6ICdwb3N0cy5odG1sJ30pXG5cdFx0XHQud2hlbignL3JlZ2lzdGVyJyAsIHtjb250cm9sbGVyOiAnUmVnaXN0ZXJDdHJsJywgdGVtcGxhdGVVcmw6ICdyZWdpc3Rlci5odG1sJ30pXG5cdFx0XHQud2hlbignL2xvZ2luJyAsIHtjb250cm9sbGVyOiAnTG9naW5DdHJsJywgdGVtcGxhdGVVcmw6ICdsb2dpbi5odG1sJ30pXG5cdFx0XHQud2hlbignL2xvZ291dCcgLCB7Y29udHJvbGxlcjogJ0xvZ2luQ3RybCcsIHRlbXBsYXRlVXJsOiAnbG9nb3V0Lmh0bWwnfSlcblx0XHRcdC53aGVuKCcvcG9zdC86eWVhci86bW9udGgvOmRheS86c2x1ZycgLCB7Y29udHJvbGxlcjogJ1NpbmdsZVBvc3RDdHJsJywgdGVtcGxhdGVVcmw6ICdzaW5nbGVQb3N0Lmh0bWwnfSlcblx0XHRcdC53aGVuKCcvcG9zdC9pZC86aWQnICwge2NvbnRyb2xsZXI6ICdTaW5nbGVQb3N0Q3RybCcsIHRlbXBsYXRlVXJsOiAnc2luZ2xlUG9zdC5odG1sJ30pXG5cdFx0XHQud2hlbignL3VzZXIvOnVzZXJuYW1lJyAsIHtjb250cm9sbGVyOiAnUHJvZmlsZUN0cmwnLCB0ZW1wbGF0ZVVybDogJ3VzZXIuaHRtbCd9KVxuXHRcdFx0LndoZW4oJy91c2VyLzp1c2VybmFtZS9lZGl0JyAsIHtjb250cm9sbGVyOiAnUHJvZmlsZUN0cmwnLCB0ZW1wbGF0ZVVybDogJ3Byb2ZpbGUvdXNlclByb2ZpbGUuaHRtbCd9KVxuXHR9XSkiLCJhbmd1bGFyLm1vZHVsZSgnYXBwJylcblx0LmNvbnRyb2xsZXIoJ1NpbmdsZVBvc3RDdHJsJywgW1wiJHNjb3BlXCIgLCBcIiRodHRwXCIsIFwiUG9zdHNTZXJ2aWNlXCIsIFwiJHJvdXRlUGFyYW1zXCIsIFwiJHJvdXRlXCIsIFwiJGxvY2F0aW9uXCIgLCBmdW5jdGlvbiAoJHNjb3BlLCAkaHR0cCwgUG9zdHNTZXJ2aWNlLCAkcm91dGVQYXJhbXMsICRyb3V0ZSwgJGxvY2F0aW9uKSB7XG5cblx0XHQkc2NvcGUuJG9uKCckdmlld0NvbnRlbnRMb2FkZWQnLCBmdW5jdGlvbigpe1xuXHRcdFx0Ly90aGUgcGFnZSBpcyByZWFkeVxuXHRcdH0pO1xuXG5cdFx0JHNjb3BlLmRlbGV0ZUl0ZW0gPSBmdW5jdGlvbiAoKSB7XG5cdFx0XHRQb3N0c1NlcnZpY2UucmVtb3ZlSXRlbSh7XG5cdFx0XHRcdFx0cG9zdF9pZDogJHNjb3BlLnBvc3QuX2lkXG5cdFx0XHRcdH0pXG5cdFx0XHRcdC5zdWNjZXNzKGZ1bmN0aW9uIChyZXNwb25zZSkge1xuXHRcdFx0XHRcdGNvbnNvbGUubG9nKHJlc3BvbnNlKTtcblx0XHRcdFx0XHQvLyBjb25maXJtIHN1Y2Nlc3NmdWwgZGVsZXRlXG5cdFx0XHRcdH0pXG5cdFx0fTtcblxuICAgICAgICB2YXIgcG9zdFNsdWcgPSAkcm91dGVQYXJhbXMuc2x1ZztcbiAgICAgICAgdmFyIHBvc3RJRCA9ICRyb3V0ZVBhcmFtcy5pZDtcblxuXHRcdGlmIChwb3N0U2x1Zykge1xuICAgICAgICAgICAgdmFyIGZ1bGxQb3N0U2x1ZyA9ICcnO1xuICAgICAgICAgICAgZnVsbFBvc3RTbHVnICs9ICRyb3V0ZVBhcmFtcy55ZWFyICsgJy8nO1xuICAgICAgICAgICAgZnVsbFBvc3RTbHVnICs9ICRyb3V0ZVBhcmFtcy5tb250aCArICcvJztcbiAgICAgICAgICAgIGZ1bGxQb3N0U2x1ZyArPSAkcm91dGVQYXJhbXMuZGF5ICsgJy8nO1xuICAgICAgICAgICAgZnVsbFBvc3RTbHVnICs9ICRyb3V0ZVBhcmFtcy5zbHVnO1xuXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhmdWxsUG9zdFNsdWcpO1xuXG4gICAgICAgICAgICBQb3N0c1NlcnZpY2Uuc2luZ2xlX3NsdWcoe1xuXHRcdFx0XHRzbHVnOiBmdWxsUG9zdFNsdWdcblx0XHRcdH0pXG5cdFx0XHQuc3VjY2VzcyhmdW5jdGlvbiAocG9zdCkge1xuXHRcdFx0XHQkc2NvcGUucG9zdCA9IHBvc3RbMF07XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coJHNjb3BlLnBvc3QpO1xuICAgICAgICAgICAgfSlcblx0XHR9XG5cdFx0ZWxzZSBpZiAocG9zdElEKSB7XG5cdFx0XHRQb3N0c1NlcnZpY2Uuc2luZ2xlX2lkKHtcblx0XHRcdFx0aWQ6IHBvc3RJRFxuXHRcdFx0fSlcdFx0XG5cdFx0XHQuc3VjY2VzcyhmdW5jdGlvbiAocG9zdCkge1xuXHRcdFx0XHQkc2NvcGUucG9zdCA9IHBvc3RbMF07XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coJHNjb3BlLnBvc3QpO1xuXHRcdFx0fSlcblx0XHR9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgLy8gdGhlIHVybCBkb2VzIG5vdCBjb250YWluIGEgdmFsaWQgcG9zdCBzbHVnIG9yIGlkXG4gICAgICAgICAgICAvLyBzaG93IGVycm9yIHRvIHVzZXJcbiAgICAgICAgfVxuXG5cdH1dKSIsImFuZ3VsYXIubW9kdWxlKCdhcHAnKVxuXHQuc2VydmljZSgnVXNlclN2YycsIFtcIiRodHRwXCIsIGZ1bmN0aW9uKCRodHRwKSB7XG5cdFx0dmFyIHN2YyA9IHRoaXM7XG5cblx0XHRzdmMuZ2V0VXNlciA9IGZ1bmN0aW9uICgpIHtcblx0XHRcdCRodHRwLmRlZmF1bHRzLmhlYWRlcnMuY29tbW9uWydYLUF1dGgnXSA9IHdpbmRvdy5sb2NhbFN0b3JhZ2UudG9rZW5cblx0XHRcdHJldHVybiAkaHR0cC5nZXQoJy9hcGkvdXNlcnMnKVxuXHRcdFx0LnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7XG4gICAgICBcdFx0XHRyZXR1cm4gcmVzcG9uc2VcbiAgICBcdFx0fSlcblx0XHR9XG5cblx0XHRzdmMubG9naW4gPSBmdW5jdGlvbiAodXNlcm5hbWUsIHBhc3N3b3JkKSB7XG5cdFx0XHRyZXR1cm4gJGh0dHAucG9zdCgnL2FwaS9zZXNzaW9ucycsIHtcblx0XHRcdFx0dXNlcm5hbWU6IHVzZXJuYW1lLCBwYXNzd29yZDogcGFzc3dvcmRcblx0XHRcdH0pXG5cdFx0XHQudGhlbihmdW5jdGlvbiAodmFsKSB7XG5cdFx0XHRcdHdpbmRvdy5sb2NhbFN0b3JhZ2UudG9rZW4gPSB2YWwuZGF0YTtcblx0XHRcdFx0JGh0dHAuZGVmYXVsdHMuaGVhZGVycy5jb21tb25bJ1gtQXV0aCddID0gdmFsLmRhdGFcblx0XHRcdFx0cmV0dXJuIHN2Yy5nZXRVc2VyKCk7XG5cdFx0XHR9KVxuXHRcdH1cblxuXHRcdHN2Yy5yZWdpc3RlciA9IGZ1bmN0aW9uICh1c2VybmFtZSwgcGFzc3dvcmQsIHBhc3N3b3JkX2NvbmZpcm0pIHtcblx0XHRcdHJldHVybiAkaHR0cC5wb3N0KCcvYXBpL3VzZXJzJywge1xuXHRcdFx0XHR1c2VybmFtZTogdXNlcm5hbWUsIHBhc3N3b3JkOiBwYXNzd29yZFxuXHRcdFx0fSlcblx0XHRcdC50aGVuKGZ1bmN0aW9uICh2YWwpIHtcblx0XHRcdFx0cmV0dXJuIHN2Yy5sb2dpbih1c2VybmFtZSwgcGFzc3dvcmQpXG5cdFx0XHRcdFx0LnRoZW4oZnVuY3Rpb24oKXtcblx0XHRcdFx0XHRcdHdpbmRvdy5sb2NhdGlvbi5ocmVmPSAnLyc7XG5cdFx0XHRcdFx0fSlcblx0XHRcdH0pXG5cdFx0fVxuXG5cdFx0c3ZjLmF1dGhvcml6YXRpb24gPSBmdW5jdGlvbiAocGVybWlzc2lvbl9sZXZlbCkge1xuXHRcdFx0JGh0dHAuZGVmYXVsdHMuaGVhZGVycy5jb21tb25bJ1gtQXV0aCddID0gd2luZG93LmxvY2FsU3RvcmFnZS50b2tlbjtcblx0XHRcdHJldHVybiAkaHR0cC5nZXQoJy9hcGkvdXNlcnMvcGVybWlzc2lvbnMnKVxuXHRcdFx0LnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7XG5cdFx0XHRcdGNvbnNvbGUubG9nKHJlc3BvbnNlKTtcblx0XHRcdFx0aWYgKHJlc3BvbnNlLmRhdGEgPiBwZXJtaXNzaW9uX2xldmVsKSB7XG5cdFx0XHRcdFx0cmV0dXJuIHRydWU7XG5cdFx0XHRcdH1cblx0XHRcdFx0cmV0dXJuIGZhbHNlO1xuXHRcdFx0fSlcblx0XHR9XG5cblx0XHRzdmMubG9nb3V0ID0gZnVuY3Rpb24gKCkge1xuXHRcdFx0d2luZG93LmxvY2FsU3RvcmFnZS5yZW1vdmVJdGVtKCd0b2tlbicpO1xuXHRcdFx0d2luZG93LmxvY2F0aW9uLmhyZWY9ICcvJztcblx0XHR9XG5cblx0XHRzdmMucHJvZmlsZSA9IGZ1bmN0aW9uICh1c2VybmFtZSkge1xuXHRcdFx0cmV0dXJuICRodHRwLmdldCgnL2FwaS91c2Vycy9wcm9maWxlJywgeyBwYXJhbXM6IHt1c2VybmFtZTogdXNlcm5hbWV9IH0pXG5cdFx0fVxuXG5cdFx0c3ZjLnByb2ZpbGVVcGRhdGUgPSBmdW5jdGlvbiAocHJvZmlsZSkge1xuXHRcdFx0cmV0dXJuICRodHRwLnBvc3QoJy9hcGkvdXNlcnMvcHJvZmlsZScsIHByb2ZpbGUgKVxuXHRcdH1cblx0fV0pIiwiYW5ndWxhci5tb2R1bGUoJ2FwcCcpXG4ucnVuKFtcIiRyb290U2NvcGVcIiwgXCIkdGltZW91dFwiICwgXCIkd2luZG93XCIgLCBmdW5jdGlvbiAoJHJvb3RTY29wZSwgJHRpbWVvdXQsICR3aW5kb3cpIHtcblxuXHR2YXIgcmVjb25uZWN0X2RlbGF5ID0gMTA7XG5cdFxuXHQoZnVuY3Rpb24gY29ubmVjdCgpe1xuXHRcdC8vaW5jcmVtZW50IHRoZSByZWNvbm5lY3QgZGVsYXkgdGltZWVyXG5cdFx0cmVjb25uZWN0X2RlbGF5ICs9IHJlY29ubmVjdF9kZWxheTtcblxuXHRcdC8vQ3JlYXRlIGEgd2Vic29ja2V0IGNvbm5lY3Rpb24gd2l0aCB0aGUgc2VydmVyXG5cdFx0dmFyIGhvc3QgPSBcIndzOi8vXCIgKyAkd2luZG93LmxvY2F0aW9uLmhvc3Rcblx0XHQgIFxuXHRcdHZhciBjb25uZWN0aW9uID0gbmV3IFdlYlNvY2tldChob3N0KVxuXG5cdFx0Y29ubmVjdGlvbi5vbm9wZW4gPSBmdW5jdGlvbiAoKSB7XG5cdFx0XHQvL2NvbnNvbGUubG9nKCdXZWJzb2NrZXQgY29ubmVjdGVkJylcblx0XHR9XG5cblxuXHRcdGNvbm5lY3Rpb24ub25jbG9zZSA9IGZ1bmN0aW9uIChlKSB7XG5cdFx0XHRjb25zb2xlLmxvZygnV2Vic29ja2V0IGNvbm5lY3Rpb24gY2xvc2VkLiBBdHRlbXB0aW5nIHRvIHJlY2Nvbm5lY3QgaW4gJyArIHJlY29ubmVjdF9kZWxheSArICcgc2Vjb25kcycgKVxuXG5cdFx0XHQkdGltZW91dChjb25uZWN0LCByZWNvbm5lY3RfZGVsYXkqMTAwMCk7XG5cdFx0fSBcblxuXHRcdGNvbm5lY3Rpb24ub25tZXNzYWdlID0gZnVuY3Rpb24gKGUpIHtcblx0XHRcdC8vY29uc29sZS5sb2coZSk7XG5cdFx0XHR2YXIgbWVzc2FnZSA9IEpTT04ucGFyc2UoZS5kYXRhKTtcblx0XHRcdFxuXHRcdFx0dmFyIG5hbWUgPSAnd3M6JyArIG1lc3NhZ2UudG9waWM7XG5cdFx0XHR2YXIgZGF0YSA9IG1lc3NhZ2UuZGF0YTtcblx0XHRcdC8vY29uc29sZS5sb2coXCJicm9hZGNhc3Rpbmc6IFwiKTtcblxuXHRcdFx0JHJvb3RTY29wZS4kYnJvYWRjYXN0KG5hbWUsIGRhdGEpO1xuXHRcdH1cblx0fSkoKVxufV0pIl0sInNvdXJjZVJvb3QiOiIvc291cmNlLyJ9