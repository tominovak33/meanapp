angular.module("app",["ngRoute","ngAnimate"]),angular.module("app").controller("ApplicationCtrl",["$scope","$rootScope","UserSvc",function(t,e,n){t.baseUrl=location.host,window.localStorage.token&&n.getUser().then(function(e){t.$emit("userLoggedIn",e.data)}),t.$on("userLoggedIn",function(e,n){t.currentUser=n}),t.logout=function(){n.logout()}}]).filter("output_html",["$sce",function(t){return function(e){return t.trustAsHtml(e)}}]).filter("startFrom",function(){return function(t,e){return t?(e=+e,t.slice(e)):[]}}),angular.module("app").directive("staticInclude",["$http","$templateCache","$compile",function(t,e,n){return function(o,r,s){var i=s.staticInclude;t.get(i,{cache:e}).success(function(t){var e=r.html(t).contents();n(e)(o)})}}]).directive("afterRender",["$timeout",function(t){var e={restrict:"A",terminal:!0,transclude:!1,link:function(e,n,o){t(e.$eval(o.afterRender),0)}};return e}]),angular.module("app").controller("LoginCtrl",["$scope","UserSvc",function(t,e){t.login=function(n,o){e.login(n,o).then(function(e){t.$emit("userLoggedIn",e.data),window.location.href="#/"},function(e){t.loginValidation="Incorrect username & password combination"})},t.logout=function(){e.logout()}}]),angular.module("app").controller("PostsCtrl",["$scope","$http","PostsService","filterFilter","UserSvc","$timeout",function(t,e,n,o,r,s){t.baseUrl=location.host,t.bodyLengthLimit=250,t.postTagsArray=[],t.ckLoaded=!1,t.posts=[],t.addPost=function(){try{var e=CKEDITOR.instances.editor1.getData()}catch(o){console.error("CKEDITOR has not been loaded")}if(!e)var e=t.postContent;var r=t.urlDate(),s=t.slugify(t.postTitle),i=r+s;e&&n.send({body:e,title:t.postTitle,tags:t.postTagsArray,slug:i}).success(function(e){t.postBody=null,CKEDITOR.instances.editor1.setData(""),t.postTitle=null})},t.$on("$includeContentLoaded",function(){t.init_ckeditor()}),t.init_ckeditor=function(){var e=!!document.getElementById("editor1");if(t.ckLoaded=!0,e){CKEDITOR.replace("editor1",{allowedContent:!0})}else t.ckLoaded=!1},t.prettifyCode=function(){PR.prettyPrint()},t.$on("ws:new_post",function(e,n){n=n[0],t.$apply(function(){t.posts.unshift(n),t.paginate()})}),t.$on("$viewContentLoaded",function(){}),t.currentPage=1,t.postsPerPage=5,t.prevPage=function(){t.currentPage>1&&t.currentPage--},t.nextPage=function(){t.currentPage<t.posts.length/t.postsPerPage&&t.currentPage++},t.setPage=function(e){t.currentPage=e},t.range=function(t){return new Array(t)},t.$watch("search",function(e){t.filteredPosts=o(t.posts,e),t.paginate(t.filteredPosts.length)},!0),t.paginate=function(e){t.numberOfPages=Math.ceil(e>0?e/t.postsPerPage:t.posts.length/t.postsPerPage)},t.urlDate=function(t){if(void 0===t)var e=new Date;else var e=new Date(t);var n=e.getDate(),o=e.getMonth()+1,r=e.getFullYear();return String(r)+"/"+String(o)+"/"+String(n)+"/"},t.$watch("postTitle",function(e){e&&t.generateSlug(e)},!0),t.generateSlug=function(){t.slug=t.urlDate()+t.slugify(t.postTitle)},t.slugify=function(t){var e=t.toLowerCase();return e=e.replace(/\s+/g,"-"),e=e.replace(/\?/g,""),e=e.replace(/\&/g,""),e=e.replace(/\=/g,"")},t.addTag=function(e){t.postTagsArray.push(e),t.postTag=""},t.removeTag=function(e){t.postTagsArray.splice(e,1)},n.get().success(function(e){t.posts=e,t.paginate(t.posts.length)})}]),angular.module("app").service("PostsService",["$http",function(t){this.get=function(){return t.get("/api/posts")},this.send=function(e){return t.post("/api/posts",e)},this.removeItem=function(e){return t.post("/api/posts/removeItem",{params:{post_id:e.post_id}})},this.single_slug=function(e){return t.get("/api/posts",{params:{post_slug:e.slug}})},this.single_id=function(e){return t.get("/api/posts",{params:{post_id:e.id}})},this.user_posts=function(e){return t.get("/api/posts",{params:{_author:e._author}})},this.filtered_posts=function(e){return t.get("/api/posts",{params:e})}}]),angular.module("app").controller("ProfileCtrl",["$scope","$http","UserSvc","PostsService","$routeParams","$route","$location",function(t,e,n,o,r,s,i){t.editPermission=function(e){n.authorization().then(function(e){t=e})},t.baseUrl=location.host;var a=r.username;t["new"]={},n.profile(a).success(function(e){t.user_profile=e,o.user_posts({_author:t.user_profile._id}).success(function(e){t.user_posts=e,t.paginate(t.user_posts.length)})}),t.checkLogin=function(){window.localStorage.token&&n.getUser().then(function(e){t.currentUser=e.data,(t.user_profile._id==t.currentUser._id||t.editPermission(t.currentUser.permission_level))&&(t.canEdit=!0)})},t.currentUser=[],t.checkLogin(),t.$on("$viewContentLoaded",function(){}),t.user_posts=[],t.currentPage=1,t.postsPerPage=5,t.prevPage=function(){t.currentPage>1&&t.currentPage--},t.nextPage=function(){t.currentPage<t.user_posts.length/t.postsPerPage&&t.currentPage++},t.setPage=function(e){t.currentPage=e},t.range=function(t){return new Array(t)},t.paginate=function(e){t.numberOfPages=Math.ceil(e>0?e/t.postsPerPage:t.user_posts.length/t.postsPerPage)},t.prettifyCode=function(){PR.prettyPrint()},t.range=function(t){return new Array(t)},n.authorization("10").then(function(t){console.log(t)}),t.saveProfile=function(){var e={_id:t.user_profile._id};for(var o in t["new"])t["new"].hasOwnProperty(o)&&""!=t["new"][o]&&(e[o]=t["new"][o]);n.profileUpdate(e).success(function(e){e.username!=t.user_profile.username?(t.returnMessage="Your username was changed so you must log in again",setTimeout(function(){window.location.href="/#/login"},1500)):t.returnMessage="Details updated successfully"})}}]),angular.module("app").controller("RegisterCtrl",["$scope","UserSvc",function(t,e){t.register=function(n,o,r){return o!=r?void(t.validationMessage="Your passwords did not match."):void e.register(n,o)}}]),angular.module("app").config(["$routeProvider",function(t){t.when("/",{controller:"PostsCtrl",templateUrl:"post/allPosts.html"}).when("/register",{controller:"RegisterCtrl",templateUrl:"register.html"}).when("/login",{controller:"LoginCtrl",templateUrl:"login.html"}).when("/post/:year/:month/:day/:slug",{controller:"SinglePostCtrl",templateUrl:"post/singlePost.html"}).when("/post/id/:id",{controller:"SinglePostCtrl",templateUrl:"singlePost.html"}).when("/post/new/",{controller:"PostsCtrl",templateUrl:"post/newPost.html"}).when("/user/:username",{controller:"ProfileCtrl",templateUrl:"post/userPosts.html"}).when("/tag/:tag",{controller:"TagCtrl",templateUrl:"post/tagPage.html"})}]),angular.module("app").controller("SinglePostCtrl",["$scope","$http","PostsService","$routeParams","$route","$location",function(t,e,n,o,r,s){t.singlePostView=!0,t.$on("$viewContentLoaded",function(){}),t.deleteItem=function(){n.removeItem({post_id:t.post._id}).success(function(t){console.log(t)})},t.prettifyCode=function(){PR.prettyPrint()};var i=o.slug,a=o.id;if(i){var u="";u+=o.year+"/",u+=o.month+"/",u+=o.day+"/",u+=o.slug,n.single_slug({slug:u}).success(function(e){t.post=e[0],console.log(t.post)})}else a&&n.single_id({id:a}).success(function(e){t.post=e[0],console.log(t.post)})}]),angular.module("app").controller("TagCtrl",["$scope","$http","UserSvc","PostsService","$routeParams","$route","$location",function(t,e,n,o,r,s,i){t.baseUrl=location.host;var a=r.tag;t["new"]={},t.tagTitle=a,t.prettifyCode=function(){PR.prettyPrint()},o.filtered_posts({tags:a}).success(function(e){t.posts=e})}]),angular.module("app").service("UserSvc",["$http",function(t){var e=this;e.getUser=function(){return t.defaults.headers.common["X-Auth"]=window.localStorage.token,t.get("/api/users").then(function(t){return t})},e.login=function(n,o){return t.post("/api/sessions",{username:n,password:o}).then(function(n){return window.localStorage.token=n.data,t.defaults.headers.common["X-Auth"]=n.data,e.getUser()})},e.register=function(n,o,r){return t.post("/api/users",{username:n,password:o}).then(function(t){return e.login(n,o).then(function(){window.location.href="/"})})},e.authorization=function(e){return t.defaults.headers.common["X-Auth"]=window.localStorage.token,t.get("/api/users/permissions").then(function(t){return console.log(t),t.data>e?!0:!1})},e.logout=function(){window.localStorage.removeItem("token"),window.location.href="/"},e.profile=function(e){return t.get("/api/users/profile",{params:{username:e}})},e.profileUpdate=function(e){return t.post("/api/users/profile",e)}}]),angular.module("app").run(["$rootScope","$timeout","$window",function(t,e,n){var o=10;!function r(){o+=o;var s="ws://"+n.location.host,i=new WebSocket(s);i.onopen=function(){},i.onclose=function(t){console.log("Websocket connection closed. Attempting to recconnect in "+o+" seconds"),e(r,1e3*o)},i.onmessage=function(e){var n=JSON.parse(e.data),o="ws:"+n.topic,r=n.data;t.$broadcast(o,r)}}()}]);
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1vZHVsZS5qcyIsImFwcGxpY2F0aW9uQ3RybC5qcyIsImN1c3RvbURpcmVjdGl2ZXMuanMiLCJsb2dpbkNydGwuanMiLCJwb3N0c0N0cmwuanMiLCJwb3N0c1NlcnZpY2UuanMiLCJwcm9maWxlQ3RybC5qcyIsInJlZ2lzdHJhdGlvbkN0cmwuanMiLCJyb3V0ZXMuanMiLCJzaW5nbGVQb3N0c0N0cmwuanMiLCJ0YWdDdHJsLmpzIiwidXNlclNlcnZpY2UuanMiLCJ3ZWJzb2NrZXRzLmpzIl0sIm5hbWVzIjpbImFuZ3VsYXIiLCJtb2R1bGUiLCJjb250cm9sbGVyIiwiJHNjb3BlIiwiJHJvb3RTY29wZSIsIlVzZXJTdmMiLCJiYXNlVXJsIiwibG9jYXRpb24iLCJob3N0Iiwid2luZG93IiwibG9jYWxTdG9yYWdlIiwidG9rZW4iLCJnZXRVc2VyIiwidGhlbiIsInJlc3BvbnNlIiwiJGVtaXQiLCJkYXRhIiwiJG9uIiwiZXZlbnQiLCJ1c2VyIiwiY3VycmVudFVzZXIiLCJsb2dvdXQiLCJmaWx0ZXIiLCIkc2NlIiwidmFsIiwidHJ1c3RBc0h0bWwiLCJpbnB1dCIsInN0YXJ0Iiwic2xpY2UiLCJkaXJlY3RpdmUiLCIkaHR0cCIsIiR0ZW1wbGF0ZUNhY2hlIiwiJGNvbXBpbGUiLCJzY29wZSIsImVsZW1lbnQiLCJhdHRycyIsInRlbXBsYXRlUGF0aCIsInN0YXRpY0luY2x1ZGUiLCJnZXQiLCJjYWNoZSIsInN1Y2Nlc3MiLCJjb250ZW50cyIsImh0bWwiLCIkdGltZW91dCIsImRlZiIsInJlc3RyaWN0IiwidGVybWluYWwiLCJ0cmFuc2NsdWRlIiwibGluayIsIiRldmFsIiwiYWZ0ZXJSZW5kZXIiLCJsb2dpbiIsInVzZXJuYW1lIiwicGFzc3dvcmQiLCJocmVmIiwiZXJyb3IiLCJsb2dpblZhbGlkYXRpb24iLCJQb3N0c1NlcnZpY2UiLCJmaWx0ZXJGaWx0ZXIiLCJib2R5TGVuZ3RoTGltaXQiLCJwb3N0VGFnc0FycmF5IiwiY2tMb2FkZWQiLCJwb3N0cyIsImFkZFBvc3QiLCJwb3N0Q29udGVudCIsIkNLRURJVE9SIiwiaW5zdGFuY2VzIiwiZWRpdG9yMSIsImdldERhdGEiLCJlcnIiLCJjb25zb2xlIiwiZGF0ZV9zbHVnIiwidXJsRGF0ZSIsInRpdGxlX3NsdWciLCJzbHVnaWZ5IiwicG9zdFRpdGxlIiwic2x1ZyIsInNlbmQiLCJib2R5IiwidGl0bGUiLCJ0YWdzIiwicG9zdCIsInBvc3RCb2R5Iiwic2V0RGF0YSIsImluaXRfY2tlZGl0b3IiLCJlZGl0b3JUZXh0QXJlYUV4aXN0cyIsImRvY3VtZW50IiwiZ2V0RWxlbWVudEJ5SWQiLCJyZXBsYWNlIiwiYWxsb3dlZENvbnRlbnQiLCJwcmV0dGlmeUNvZGUiLCJQUiIsInByZXR0eVByaW50IiwiXyIsIiRhcHBseSIsInVuc2hpZnQiLCJwYWdpbmF0ZSIsImN1cnJlbnRQYWdlIiwicG9zdHNQZXJQYWdlIiwicHJldlBhZ2UiLCJuZXh0UGFnZSIsImxlbmd0aCIsInNldFBhZ2UiLCJwYWdlX251bWJlciIsInJhbmdlIiwibiIsIkFycmF5IiwiJHdhdGNoIiwidGVybSIsImZpbHRlcmVkUG9zdHMiLCJudW1iZXJfb2ZfaXRlbXMiLCJudW1iZXJPZlBhZ2VzIiwiTWF0aCIsImNlaWwiLCJ0aW1lIiwidW5kZWZpbmVkIiwiZGF0ZSIsIkRhdGUiLCJkYXkiLCJnZXREYXRlIiwibW9udGgiLCJnZXRNb250aCIsInllYXIiLCJnZXRGdWxsWWVhciIsIlN0cmluZyIsImdlbmVyYXRlU2x1ZyIsInN0cmluZyIsInRvTG93ZXJDYXNlIiwiYWRkVGFnIiwidGFnIiwicHVzaCIsInBvc3RUYWciLCJyZW1vdmVUYWciLCJ0YWdJbmRleCIsInNwbGljZSIsInNlcnZpY2UiLCJ0aGlzIiwicmVtb3ZlSXRlbSIsInBhcmFtZXRlcnMiLCJwYXJhbXMiLCJwb3N0X2lkIiwic2luZ2xlX3NsdWciLCJwb3N0X3NsdWciLCJzaW5nbGVfaWQiLCJpZCIsInVzZXJfcG9zdHMiLCJfYXV0aG9yIiwiZmlsdGVyZWRfcG9zdHMiLCJzZWFyY2hQYXJhbXMiLCIkcm91dGVQYXJhbXMiLCIkcm91dGUiLCIkbG9jYXRpb24iLCJlZGl0UGVybWlzc2lvbiIsInBlcm1pc3Npb25fbGV2ZWwiLCJhdXRob3JpemF0aW9uIiwicHJvZmlsZSIsInVzZXJfcHJvZmlsZSIsIl9pZCIsImNoZWNrTG9naW4iLCJjYW5FZGl0IiwibG9nIiwic2F2ZVByb2ZpbGUiLCJwcm9maWxlX2RldGFpbHMiLCJrZXkiLCJoYXNPd25Qcm9wZXJ0eSIsInByb2ZpbGVVcGRhdGUiLCJyZXR1cm5NZXNzYWdlIiwic2V0VGltZW91dCIsInJlZ2lzdGVyIiwicGFzc3dvcmRfY29uZmlybSIsInZhbGlkYXRpb25NZXNzYWdlIiwiY29uZmlnIiwiJHJvdXRlUHJvdmlkZXIiLCJ3aGVuIiwidGVtcGxhdGVVcmwiLCJzaW5nbGVQb3N0VmlldyIsImRlbGV0ZUl0ZW0iLCJwb3N0U2x1ZyIsInBvc3RJRCIsImZ1bGxQb3N0U2x1ZyIsInRhZ1RpdGxlIiwidGFnZ2VkUG9zdHMiLCJzdmMiLCJkZWZhdWx0cyIsImhlYWRlcnMiLCJjb21tb24iLCJydW4iLCIkd2luZG93IiwicmVjb25uZWN0X2RlbGF5IiwiY29ubmVjdCIsImNvbm5lY3Rpb24iLCJXZWJTb2NrZXQiLCJvbm9wZW4iLCJvbmNsb3NlIiwiZSIsIm9ubWVzc2FnZSIsIm1lc3NhZ2UiLCJKU09OIiwicGFyc2UiLCJuYW1lIiwidG9waWMiLCIkYnJvYWRjYXN0Il0sIm1hcHBpbmdzIjoiQUFDQUEsUUFBQUMsT0FBQSxPQUFBLFVBQUEsY0NEQUQsUUFBQUMsT0FBQSxPQUNBQyxXQUFBLG1CQUFBLFNBQUEsYUFBQSxVQUFBLFNBQUFDLEVBQUFDLEVBQUFDLEdBTUFGLEVBQUFHLFFBQUFDLFNBQUFDLEtBR0FDLE9BQUFDLGFBQUFDLE9BQ0FOLEVBQUFPLFVBQ0FDLEtBQUEsU0FBQUMsR0FDQVgsRUFBQVksTUFBQSxlQUFBRCxFQUFBRSxRQUlBYixFQUFBYyxJQUFBLGVBQUEsU0FBQUMsRUFBQUMsR0FDQWhCLEVBQUFpQixZQUFBRCxJ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LFFBQUEsU0FBQXZHLEdBQ0EsTUFBQXRCLEdBQUFRLElBQUEsc0JBQUFxRyxRQUFBdkYsU0FBQUEsTUFHQWtJLEVBQUFqQixjQUFBLFNBQUFWLEdBQ0EsTUFBQTdILEdBQUFtRCxLQUFBLHFCQUFBMEUsT0N6REEzSixRQUFBQyxPQUFBLE9BQ0F5TCxLQUFBLGFBQUEsV0FBQSxVQUFBLFNBQUF0TCxFQUFBdUMsRUFBQWdKLEdBRUEsR0FBQUMsR0FBQSxJQUVBLFFBQUFDLEtBRUFELEdBQUFBLENBR0EsSUFBQXBMLEdBQUEsUUFBQW1MLEVBQUFwTCxTQUFBQyxLQUVBc0wsRUFBQSxHQUFBQyxXQUFBdkwsRUFFQXNMLEdBQUFFLE9BQUEsYUFLQUYsRUFBQUcsUUFBQSxTQUFBQyxHQUNBNUgsUUFBQTBGLElBQUEsNERBQUE0QixFQUFBLFlBRUFqSixFQUFBa0osRUFBQSxJQUFBRCxJQUdBRSxFQUFBSyxVQUFBLFNBQUFELEdBRUEsR0FBQUUsR0FBQUMsS0FBQUMsTUFBQUosRUFBQWxMLE1BRUF1TCxFQUFBLE1BQUFILEVBQUFJLE1BQ0F4TCxFQUFBb0wsRUFBQXBMLElBR0FaLEdBQUFxTSxXQUFBRixFQUFBdkwiLCJmaWxlIjoiYXBwLmpzIiwic291cmNlc0NvbnRlbnQiOlsiLy9UaGlzIGZpbGUgbXVzdCBiZSB0aGUgZmlyc3QgaW4gdGhlIGxpc3QgdG8gYmUgY29uY2F0ZW5hdGVkXG5hbmd1bGFyLm1vZHVsZSgnYXBwJywgWyduZ1JvdXRlJywgJ25nQW5pbWF0ZSddKSIsImFuZ3VsYXIubW9kdWxlKCdhcHAnKVxuXHQuY29udHJvbGxlcignQXBwbGljYXRpb25DdHJsJyAsIFtcIiRzY29wZVwiLCBcIiRyb290U2NvcGVcIiwgXCJVc2VyU3ZjXCIsIGZ1bmN0aW9uICgkc2NvcGUsICRyb290U2NvcGUsIFVzZXJTdmMpIHtcblx0XHQvKlxuXHRcdElmIHdlIGhhdmUgYSBzdG9yZWQgdG9rZW4sIGdldCB0aGUgdXNlciBpbmZvcm1hdGlvbiBmcm9tIGl0XG5cdFx0YW5kIGVtaXQgdGhlIHVzZXIgbG9nZ2VkaW4gbWVzc2FnZXMgaW4gb3JkZXIgdG8gYWxsb3cgdGhlIFVJIHRvIFxuXHRcdGluZGljYXRlIHRvIHRoZSB1c2VyIHRoYXQgdGhleSB3ZXJlIGxvZ2dlZCBpblxuXHRcdCovXG5cdFx0JHNjb3BlLmJhc2VVcmwgPSBsb2NhdGlvbi5ob3N0O1xuXG5cdFx0XG5cdFx0aWYgKHdpbmRvdy5sb2NhbFN0b3JhZ2UudG9rZW4pIHtcblx0XHRcdFVzZXJTdmMuZ2V0VXNlcigpXG5cdFx0XHRcdC50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSl7XG5cdFx0XHRcdFx0JHNjb3BlLiRlbWl0KCd1c2VyTG9nZ2VkSW4nLCByZXNwb25zZS5kYXRhKTtcblx0XHRcdFx0fSlcblx0XHR9XG5cblx0XHQkc2NvcGUuJG9uKCd1c2VyTG9nZ2VkSW4nLCBmdW5jdGlvbihldmVudCwgdXNlcikge1xuXHRcdFx0JHNjb3BlLmN1cnJlbnRVc2VyID0gdXNlcjtcblx0XHR9KVxuXG5cdFx0JHNjb3BlLmxvZ291dCA9IGZ1bmN0aW9uICgpIHtcblx0XHRcdFVzZXJTdmMubG9nb3V0KCk7XG5cdFx0fVxuXHR9XSlcblxuXHQuZmlsdGVyKCdvdXRwdXRfaHRtbCcsIFtcIiRzY2VcIiwgZnVuY3Rpb24gKCRzY2UpIHtcblx0XHRyZXR1cm4gZnVuY3Rpb24odmFsKSB7XG5cdCAgICAgICAgcmV0dXJuICRzY2UudHJ1c3RBc0h0bWwodmFsKTtcblx0ICAgIH07XG5cdH1dKVxuXG5cdC5maWx0ZXIoJ3N0YXJ0RnJvbScsIGZ1bmN0aW9uKCkge1xuXHQgICAgcmV0dXJuIGZ1bmN0aW9uKGlucHV0LCBzdGFydCkge1xuXHQgICAgICAgIGlmKGlucHV0KSB7XG5cdCAgICAgICAgICAgIHN0YXJ0ID0gK3N0YXJ0OyAvL3BhcnNlIHRvIGludFxuXHQgICAgICAgICAgICByZXR1cm4gaW5wdXQuc2xpY2Uoc3RhcnQpO1xuXHQgICAgICAgIH1cblx0ICAgICAgICByZXR1cm4gW107XG5cdCAgICB9XG5cdH0pOyIsIi8qKlxuICogQ3JlYXRlZCBieSB0b21pIG9uIDE5LzAxLzE2LlxuICovXG5hbmd1bGFyLm1vZHVsZSgnYXBwJylcbiAgICAuZGlyZWN0aXZlKCdzdGF0aWNJbmNsdWRlJywgWyckaHR0cCcsICckdGVtcGxhdGVDYWNoZScsICckY29tcGlsZScsIGZ1bmN0aW9uICgkaHR0cCwgJHRlbXBsYXRlQ2FjaGUsICRjb21waWxlKSB7XG4gICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24oc2NvcGUsIGVsZW1lbnQsIGF0dHJzKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRlbXBsYXRlUGF0aCA9IGF0dHJzLnN0YXRpY0luY2x1ZGU7XG4gICAgICAgICAgICAgICAgJGh0dHAuZ2V0KHRlbXBsYXRlUGF0aCwgeyBjYWNoZTogJHRlbXBsYXRlQ2FjaGUgfSkuc3VjY2VzcyhmdW5jdGlvbihyZXNwb25zZSkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgY29udGVudHMgPSBlbGVtZW50Lmh0bWwocmVzcG9uc2UpLmNvbnRlbnRzKCk7XG4gICAgICAgICAgICAgICAgICAgICRjb21waWxlKGNvbnRlbnRzKShzY29wZSk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9O1xuICAgIH1dKVxuICAgIC5kaXJlY3RpdmUoJ2FmdGVyUmVuZGVyJywgWyckdGltZW91dCcsIGZ1bmN0aW9uICgkdGltZW91dCkge1xuICAgICAgICB2YXIgZGVmID0ge1xuICAgICAgICAgICAgcmVzdHJpY3Q6ICdBJyxcbiAgICAgICAgICAgIHRlcm1pbmFsOiB0cnVlLFxuICAgICAgICAgICAgdHJhbnNjbHVkZTogZmFsc2UsXG4gICAgICAgICAgICBsaW5rOiBmdW5jdGlvbiAoc2NvcGUsIGVsZW1lbnQsIGF0dHJzKSB7XG4gICAgICAgICAgICAgICAgJHRpbWVvdXQoc2NvcGUuJGV2YWwoYXR0cnMuYWZ0ZXJSZW5kZXIpLCAwKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgcmV0dXJuIGRlZjtcbiAgICAgICAgLy9odHRwOi8vZ3NmZXJyZWlyYS5jb20vYXJjaGl2ZS8yMDE1LzAzL2FuZ3VsYXJqcy1hZnRlci1yZW5kZXItZGlyZWN0aXZlL1xuICAgIH1dKSIsImFuZ3VsYXIubW9kdWxlKCdhcHAnKVxuXHQuY29udHJvbGxlcignTG9naW5DdHJsJyAsIFtcIiRzY29wZVwiICwgXCJVc2VyU3ZjXCIgLCBmdW5jdGlvbiAoJHNjb3BlLCBVc2VyU3ZjKSB7XG5cdFx0JHNjb3BlLmxvZ2luID0gZnVuY3Rpb24gKHVzZXJuYW1lLCBwYXNzd29yZCkge1xuXHRcdFx0VXNlclN2Yy5sb2dpbih1c2VybmFtZSwgcGFzc3dvcmQpXG5cdFx0XHRcdC50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSl7XG5cdFx0XHRcdFx0JHNjb3BlLiRlbWl0KCd1c2VyTG9nZ2VkSW4nLCByZXNwb25zZS5kYXRhKTtcblx0XHRcdFx0XHR3aW5kb3cubG9jYXRpb24uaHJlZiA9ICcjLydcblx0XHRcdFx0fSxcblx0XHRcdFx0ZnVuY3Rpb24oZXJyb3Ipe1xuXHRcdFx0XHQgICRzY29wZS5sb2dpblZhbGlkYXRpb24gPSAnSW5jb3JyZWN0IHVzZXJuYW1lICYgcGFzc3dvcmQgY29tYmluYXRpb24nO1xuXHRcdFx0XHR9KVxuXG5cdFx0fVxuXG5cdFx0JHNjb3BlLmxvZ291dCA9IGZ1bmN0aW9uICgpIHtcblx0XHRcdFVzZXJTdmMubG9nb3V0KClcblx0XHR9XG5cdH1dKSIsImFuZ3VsYXIubW9kdWxlKCdhcHAnKVxuXHQuY29udHJvbGxlcignUG9zdHNDdHJsJywgW1wiJHNjb3BlXCIgLCBcIiRodHRwXCIsIFwiUG9zdHNTZXJ2aWNlXCIsIFwiZmlsdGVyRmlsdGVyXCIsIFwiVXNlclN2Y1wiLCBcIiR0aW1lb3V0XCIsIGZ1bmN0aW9uICgkc2NvcGUsICRodHRwLCBQb3N0c1NlcnZpY2UsIGZpbHRlckZpbHRlciwgVXNlclN2YywgJHRpbWVvdXQpIHtcblx0XHQkc2NvcGUuYmFzZVVybCA9IGxvY2F0aW9uLmhvc3Q7XG5cdFx0JHNjb3BlLmJvZHlMZW5ndGhMaW1pdCA9IDI1MDtcblx0XHQkc2NvcGUucG9zdFRhZ3NBcnJheSA9IFtdO1xuXHRcdCRzY29wZS5ja0xvYWRlZCA9IGZhbHNlO1xuXG5cdFx0JHNjb3BlLnBvc3RzID0gW107XG5cdFx0JHNjb3BlLmFkZFBvc3QgPSBmdW5jdGlvbiAoKSB7XG5cdFx0XHR0cnkge1xuXHRcdFx0XHR2YXIgcG9zdENvbnRlbnQgPSBDS0VESVRPUi5pbnN0YW5jZXMuZWRpdG9yMS5nZXREYXRhKCk7XG5cdFx0XHR9XG5cdFx0XHRjYXRjaChlcnIpIHtcblx0XHRcdFx0Ly8gY2tlZGl0b3IgaXMgbm90IGxvYWRlZFxuXHRcdFx0XHRjb25zb2xlLmVycm9yKFwiQ0tFRElUT1IgaGFzIG5vdCBiZWVuIGxvYWRlZFwiKTtcblx0XHRcdH1cblx0XHRcdGlmICghcG9zdENvbnRlbnQpIHtcblx0XHRcdFx0dmFyIHBvc3RDb250ZW50ID0gJHNjb3BlLnBvc3RDb250ZW50O1xuXHRcdFx0fVxuXG5cdFx0XHR2YXIgZGF0ZV9zbHVnID0gJHNjb3BlLnVybERhdGUoKTtcblx0XHRcdHZhciB0aXRsZV9zbHVnID0gJHNjb3BlLnNsdWdpZnkoJHNjb3BlLnBvc3RUaXRsZSk7XG5cblx0XHRcdHZhciBzbHVnID0gZGF0ZV9zbHVnICsgdGl0bGVfc2x1ZztcblxuXHRcdFx0aWYgKHBvc3RDb250ZW50KSB7XG5cdFx0XHRcdFBvc3RzU2VydmljZS5zZW5kKHtcblx0XHRcdFx0XHRib2R5OiBwb3N0Q29udGVudCxcblx0XHRcdFx0XHR0aXRsZTogJHNjb3BlLnBvc3RUaXRsZSxcblx0XHRcdFx0XHR0YWdzOiAkc2NvcGUucG9zdFRhZ3NBcnJheSxcblx0XHRcdFx0XHRzbHVnOiBzbHVnXG5cdFx0XHRcdH0pXG5cdFx0XHRcdC5zdWNjZXNzKGZ1bmN0aW9uIChwb3N0KSB7XG5cdFx0XHRcdFx0Lypcblx0XHRcdFx0XHQvL1JlbW92ZWQgYXMgd2Vic29ja2V0IGJyb2FkY2FzdCB3b3VsZCBjYXVzZSB0aGUgcG9zdCB0byBhcHBlYXIgZHVwbGljYXRlZCBvbiB0aGUgYnJvd3NlciB0aGF0IGl0IHdhcyBwb3N0ZWQgZnJvbSBcblx0XHRcdFx0XHQvL2FzIGJvdGggb2YgdGhlIGZ1bmN0aW9ucyB3b3VsZCBnZXQgZXhlY3V0ZWQgYmVjYXVzZSB0aGUgY2xpZW50IHdobyBzZW5kcyB0aGUgcG9zdCB3b3VsZCBzdGlsbCByZWNpZXZlIHRoZSB3ZWJzb2NrZXRzIGJyb2FkY2FzdCBiYWNrIGZyb20gdGhlIHNlcnZlciAgXG5cdFx0XHRcdFx0Ki9cblx0XHRcdFx0XHQkc2NvcGUucG9zdEJvZHkgPSBudWxsO1xuXHRcdFx0XHRcdENLRURJVE9SLmluc3RhbmNlcy5lZGl0b3IxLnNldERhdGEoJycpO1xuXHRcdFx0XHRcdCRzY29wZS5wb3N0VGl0bGUgPSBudWxsO1xuXHRcdFx0XHR9KVxuXHRcdFx0fVxuXHRcdH07XG5cblx0XHQkc2NvcGUuJG9uKCckaW5jbHVkZUNvbnRlbnRMb2FkZWQnLCBmdW5jdGlvbiAoKSB7XG5cdFx0XHQkc2NvcGUuaW5pdF9ja2VkaXRvcigpO1xuXHRcdH0pO1xuXG5cdFx0JHNjb3BlLmluaXRfY2tlZGl0b3IgPSBmdW5jdGlvbiAoKSB7XG5cdFx0XHR2YXIgZWRpdG9yVGV4dEFyZWFFeGlzdHMgPSAhIWRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiZWRpdG9yMVwiKTtcblxuXHRcdFx0JHNjb3BlLmNrTG9hZGVkID0gdHJ1ZTtcblxuXHRcdFx0aWYgKGVkaXRvclRleHRBcmVhRXhpc3RzKSB7XG5cdFx0XHRcdHZhciBlZGl0b3IgPSBDS0VESVRPUi5yZXBsYWNlKCdlZGl0b3IxJywge1xuXHRcdFx0XHRcdGFsbG93ZWRDb250ZW50IDogdHJ1ZVxuXHRcdFx0XHR9KTtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdCRzY29wZS5ja0xvYWRlZCA9IGZhbHNlO1xuXHRcdFx0fVxuXHRcdH07XG5cblx0XHQkc2NvcGUucHJldHRpZnlDb2RlID0gZnVuY3Rpb24oKSB7XG5cdFx0XHRQUi5wcmV0dHlQcmludCgpO1xuXHRcdH07XG5cblx0XHQkc2NvcGUuJG9uKCd3czpuZXdfcG9zdCcsIGZ1bmN0aW9uKF8sIHBvc3QpIHtcblx0XHRcdHBvc3QgPSBwb3N0WzBdO1xuXHRcdFx0JHNjb3BlLiRhcHBseShmdW5jdGlvbiAoKSB7XG5cdFx0XHRcdCRzY29wZS5wb3N0cy51bnNoaWZ0KHBvc3QpO1xuXHRcdFx0XHQkc2NvcGUucGFnaW5hdGUoKTtcblx0XHRcdH0pXG5cdFx0fSk7XG5cblx0XHQkc2NvcGUuJG9uKCckdmlld0NvbnRlbnRMb2FkZWQnLCBmdW5jdGlvbigpe1xuXHRcdFx0Ly90aGUgcGFnZSBpcyByZWFkeVxuXHRcdH0pO1xuXG5cdFx0JHNjb3BlLmN1cnJlbnRQYWdlID0gMTtcblx0XHQkc2NvcGUucG9zdHNQZXJQYWdlID0gNTtcblxuXHRcdCRzY29wZS5wcmV2UGFnZSA9IGZ1bmN0aW9uICgpIHtcblx0ICAgICAgICBpZiAoJHNjb3BlLmN1cnJlbnRQYWdlID4gMSkge1xuXHQgICAgICAgICAgICAkc2NvcGUuY3VycmVudFBhZ2UtLTtcblx0ICAgICAgICB9XG5cdCAgICB9O1xuICAgIFxuXHQgICAgJHNjb3BlLm5leHRQYWdlID0gZnVuY3Rpb24gKCkge1xuXHQgICAgICAgIGlmICgkc2NvcGUuY3VycmVudFBhZ2UgPCAkc2NvcGUucG9zdHMubGVuZ3RoLyRzY29wZS5wb3N0c1BlclBhZ2UpIHtcblx0ICAgICAgICAgICAgJHNjb3BlLmN1cnJlbnRQYWdlKys7XG5cdCAgICAgICAgfVxuXHQgICAgfTtcblx0ICAgIFxuXHQgICAgJHNjb3BlLnNldFBhZ2UgPSBmdW5jdGlvbiAocGFnZV9udW1iZXIpIHtcblx0ICAgICAgICAkc2NvcGUuY3VycmVudFBhZ2UgPSBwYWdlX251bWJlcjtcblx0ICAgIH07XG5cblx0ICAgIC8vVGhpcyB3YXkgSSBjYW4gZG86ICBcIjxsaSBuZy1yZXBlYXQ9XCJuIGluIHJhbmdlKHBhZ2VzKSB0cmFjayBieSAkaW5kZXhcIj5cIiBhbmQgc28gSSBjYW4gZGlzcGxheSBhcyBtYW55IGl0ZW1zIGFzIHRoZSB2YWx1ZSBvZiBhIG51bWJlciBhcyB0aGlzIHJldHVybnMgYW4gYXJyYXkgb2YgdGhhdCBsZW5naHRcblx0ICAgICRzY29wZS5yYW5nZSA9IGZ1bmN0aW9uKG4pIHtcbiAgICAgICAgXHRyZXR1cm4gbmV3IEFycmF5KG4pO1xuICAgIFx0fTtcblx0ICAgIFxuXHQgICAgLy93YXRjaCB0byBzZWUgaWYgc2VhcmNoaW5nIGFuZCByZXBhZ2luYXRlIGlmIHdlIGFyZVxuXHQgICAgLy90cnVlIGF0IHRoZSBlbmQgIG1hZ2ljYWxseSBtYWtlcyBpdCBzbyB0aGF0IGFzIGVhY2ggZXh0cmEgbGV0dGVyIGlzIGFkZGVkIHRvIHRoZSBzZWFyY2ggd2UgY2FuIHJlcGFnaW5hdGVcblx0ICAgIC8vd2l0aG91dCB0aGUgJ3RydWUnIGl0IG9ubHkgZGlkICB0aGF0XG5cdCAgICAkc2NvcGUuJHdhdGNoKCdzZWFyY2gnLCBmdW5jdGlvbih0ZXJtKSB7XG5cdCAgICAgICAgJHNjb3BlLmZpbHRlcmVkUG9zdHMgPSBmaWx0ZXJGaWx0ZXIoJHNjb3BlLnBvc3RzLCB0ZXJtKTtcblx0ICAgICAgICAkc2NvcGUucGFnaW5hdGUoJHNjb3BlLmZpbHRlcmVkUG9zdHMubGVuZ3RoKTtcblx0ICAgIH0sIHRydWUpO1xuXG5cblx0ICAgICRzY29wZS5wYWdpbmF0ZSA9IGZ1bmN0aW9uKG51bWJlcl9vZl9pdGVtcyl7XG5cdCAgICBcdGlmIChudW1iZXJfb2ZfaXRlbXMgPiAwKSB7XG5cdCAgICAgICAgXHQkc2NvcGUubnVtYmVyT2ZQYWdlcyA9IE1hdGguY2VpbChudW1iZXJfb2ZfaXRlbXMvJHNjb3BlLnBvc3RzUGVyUGFnZSk7XG5cdCAgICAgICAgfVxuXHQgICAgICAgIGVsc2Uge1xuXHQgICAgICAgIFx0JHNjb3BlLm51bWJlck9mUGFnZXMgPSBNYXRoLmNlaWwoJHNjb3BlLnBvc3RzLmxlbmd0aC8kc2NvcGUucG9zdHNQZXJQYWdlKTtcblx0ICAgICAgICB9XG5cdCAgICB9O1xuXG5cdCAgICAkc2NvcGUudXJsRGF0ZSA9IGZ1bmN0aW9uKHRpbWUpIHtcblx0XHRcdGlmICh0aW1lID09PSB1bmRlZmluZWQpIHtcblx0XHRcdFx0dmFyIGRhdGUgPSBuZXcgRGF0ZSgpO1xuXHRcdFx0fVxuXHRcdFx0ZWxzZSB7XG5cdFx0XHRcdHZhciBkYXRlID0gbmV3IERhdGUodGltZSk7XG5cdFx0XHR9XG5cdFx0ICAgIHZhciBkYXkgPSBkYXRlLmdldERhdGUoKTtcblx0XHQgICAgdmFyIG1vbnRoID0gZGF0ZS5nZXRNb250aCgpKzE7IC8vKzEgYmVjYXVzZSBtb250aHMgYXJlIDAgaW5kZXhlZFxuXHRcdCAgICB2YXIgeWVhciA9IGRhdGUuZ2V0RnVsbFllYXIoKTtcblxuICAgICAgICAgICAgcmV0dXJuIFN0cmluZyh5ZWFyKSArICcvJyArIFN0cmluZyhtb250aCkgKyAnLycgKyBTdHJpbmcoZGF5KSArICcvJyA7XG4gICAgICAgIH07XG5cblx0XHQkc2NvcGUuJHdhdGNoKCdwb3N0VGl0bGUnLCBmdW5jdGlvbih0aXRsZSkge1xuXHRcdFx0aWYgKHRpdGxlKSB7XG5cdFx0XHRcdCRzY29wZS5nZW5lcmF0ZVNsdWcodGl0bGUpO1xuXHRcdFx0fVxuXHRcdH0sIHRydWUpO1xuXG5cdFx0JHNjb3BlLmdlbmVyYXRlU2x1ZyA9IGZ1bmN0aW9uICgpIHtcblx0XHRcdCRzY29wZS5zbHVnID0gJHNjb3BlLnVybERhdGUoKSArICRzY29wZS5zbHVnaWZ5KCRzY29wZS5wb3N0VGl0bGUpO1xuXHRcdH07XG5cblx0ICAgICRzY29wZS5zbHVnaWZ5ID0gZnVuY3Rpb24oc3RyaW5nKSB7XG5cdCAgICBcdHZhciBzbHVnID0gIHN0cmluZy50b0xvd2VyQ2FzZSgpO1xuXHQgICAgXHRzbHVnID0gc2x1Zy5yZXBsYWNlKC9cXHMrL2csXCItXCIpO1xuXHQgICAgXHRzbHVnID0gc2x1Zy5yZXBsYWNlKC9cXD8vZywgXCJcIik7XG5cdCAgICBcdHNsdWcgPSBzbHVnLnJlcGxhY2UoL1xcJi9nLCBcIlwiKTtcblx0ICAgIFx0c2x1ZyA9IHNsdWcucmVwbGFjZSgvXFw9L2csIFwiXCIpO1xuXHQgICAgXHRyZXR1cm4gc2x1Zztcblx0ICAgIH07XG5cblx0XHQkc2NvcGUuYWRkVGFnID0gZnVuY3Rpb24odGFnKSB7XG5cdFx0XHQvL2NvbnNvbGUubG9nKHRhZyk7XG5cdFx0XHQkc2NvcGUucG9zdFRhZ3NBcnJheS5wdXNoKHRhZyk7XG5cdFx0XHQkc2NvcGUucG9zdFRhZyA9ICcnO1xuXHRcdH07XG5cblx0XHQkc2NvcGUucmVtb3ZlVGFnID0gZnVuY3Rpb24odGFnSW5kZXgpIHtcblx0XHRcdCRzY29wZS5wb3N0VGFnc0FycmF5LnNwbGljZSh0YWdJbmRleCwgMSk7XG5cdFx0fTtcblxuXHRQb3N0c1NlcnZpY2UuZ2V0KClcblx0XHQuc3VjY2VzcyhmdW5jdGlvbiAocG9zdHMpIHtcblx0XHRcdCRzY29wZS5wb3N0cyA9IHBvc3RzO1xuXHRcdFx0Ly9jb25zb2xlLmxvZyhwb3N0cyk7IC8vTG9nIGFsbCB0aGUgcG9zdHMgcmVjaWV2ZWQgZnJvbSB0aGUgc2VydmVyXG5cdFx0XHQkc2NvcGUucGFnaW5hdGUoJHNjb3BlLnBvc3RzLmxlbmd0aCk7XG5cdFx0fSlcblxuXHR9XSkiLCJhbmd1bGFyLm1vZHVsZSgnYXBwJylcblx0LnNlcnZpY2UoJ1Bvc3RzU2VydmljZScsIFtcIiRodHRwXCIgLCBmdW5jdGlvbiAoJGh0dHApIHtcblx0XHR0aGlzLmdldCA9IGZ1bmN0aW9uICgpIHtcblx0XHRcdHJldHVybiAkaHR0cC5nZXQoJy9hcGkvcG9zdHMnKTtcblx0XHR9XG5cdFx0dGhpcy5zZW5kID0gZnVuY3Rpb24gKHBvc3QpIHtcblx0XHRcdHJldHVybiAkaHR0cC5wb3N0KCcvYXBpL3Bvc3RzJywgcG9zdCk7XG5cdFx0fVxuXHRcdHRoaXMucmVtb3ZlSXRlbSA9IGZ1bmN0aW9uIChwYXJhbWV0ZXJzKSB7XG5cdFx0XHRyZXR1cm4gJGh0dHAucG9zdCgnL2FwaS9wb3N0cy9yZW1vdmVJdGVtJywgeyBwYXJhbXM6IHtwb3N0X2lkOiBwYXJhbWV0ZXJzLnBvc3RfaWR9IH0pO1xuXHRcdH1cblx0XHR0aGlzLnNpbmdsZV9zbHVnID0gZnVuY3Rpb24gKHBhcmFtZXRlcnMpIHtcblx0XHRcdHJldHVybiAkaHR0cC5nZXQoJy9hcGkvcG9zdHMnLCB7IHBhcmFtczoge3Bvc3Rfc2x1ZzogcGFyYW1ldGVycy5zbHVnfSB9ICk7XG5cdFx0fVxuXHRcdHRoaXMuc2luZ2xlX2lkID0gZnVuY3Rpb24gKHBhcmFtZXRlcnMpIHtcblx0XHRcdHJldHVybiAkaHR0cC5nZXQoJy9hcGkvcG9zdHMnLCB7IHBhcmFtczoge3Bvc3RfaWQ6IHBhcmFtZXRlcnMuaWR9IH0gKTtcblx0XHR9XG5cdFx0dGhpcy51c2VyX3Bvc3RzID0gZnVuY3Rpb24gKHBhcmFtZXRlcnMpIHtcblx0XHRcdHJldHVybiAkaHR0cC5nZXQoJy9hcGkvcG9zdHMnLCB7IHBhcmFtczoge19hdXRob3I6IHBhcmFtZXRlcnMuX2F1dGhvcn0gfSApO1xuXHRcdH1cblx0XHR0aGlzLmZpbHRlcmVkX3Bvc3RzID0gZnVuY3Rpb24gKHNlYXJjaFBhcmFtcykge1xuXHRcdFx0cmV0dXJuICRodHRwLmdldCgnL2FwaS9wb3N0cycsIHsgcGFyYW1zOiBzZWFyY2hQYXJhbXMgfSApO1xuXHRcdH1cblx0fV0pIiwiYW5ndWxhci5tb2R1bGUoJ2FwcCcpXG5cdC5jb250cm9sbGVyKCdQcm9maWxlQ3RybCcsIFtcIiRzY29wZVwiICwgXCIkaHR0cFwiLCBcIlVzZXJTdmNcIiwgXCJQb3N0c1NlcnZpY2VcIiAsIFwiJHJvdXRlUGFyYW1zXCIsIFwiJHJvdXRlXCIsIFwiJGxvY2F0aW9uXCIgLCBmdW5jdGlvbiAoJHNjb3BlLCAkaHR0cCwgVXNlclN2YywgUG9zdHNTZXJ2aWNlLCAkcm91dGVQYXJhbXMsICRyb3V0ZSwgJGxvY2F0aW9uKSB7XG5cblxuXHRcdC8qLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXHRcdC8gR2V0IHVzZXIgcGVybWlzc2lvbnNcblx0XHQvLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSovXG5cdFx0JHNjb3BlLmVkaXRQZXJtaXNzaW9uID0gZnVuY3Rpb24ocGVybWlzc2lvbl9sZXZlbCkge1xuXHRcdCAgXHRVc2VyU3ZjLmF1dGhvcml6YXRpb24oKVxuXHRcdFx0XHQudGhlbihmdW5jdGlvbiAocmVzcG9uc2Upe1xuXHRcdFx0XHRcdCRzY29wZT0ocmVzcG9uc2UpO1xuXHRcdFx0XHR9KVxuXHRcdH1cblx0XHQvKi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblx0XHQvIEVuZCB1c2VyIHBlcm1pc3Npb25zXG5cdFx0Ly0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qL1xuXG5cblx0XHQkc2NvcGUuYmFzZVVybCA9IGxvY2F0aW9uLmhvc3Q7XG5cdFx0dmFyIHVzZXJuYW1lID0gJHJvdXRlUGFyYW1zLnVzZXJuYW1lO1xuXHRcdCRzY29wZS5uZXcgID0ge307XG5cblx0XHRVc2VyU3ZjLnByb2ZpbGUodXNlcm5hbWUpXG5cdFx0XHQuc3VjY2VzcyhmdW5jdGlvbiAodXNlcl9wcm9maWxlKSB7XG5cdFx0XHRcdCRzY29wZS51c2VyX3Byb2ZpbGUgPSB1c2VyX3Byb2ZpbGU7XG5cdFx0XHRcdFBvc3RzU2VydmljZS51c2VyX3Bvc3RzICh7XG5cdFx0XHRcdFx0X2F1dGhvcjogJHNjb3BlLnVzZXJfcHJvZmlsZS5faWRcblx0XHRcdFx0fSlcblx0XHRcdFx0XHQuc3VjY2VzcyhmdW5jdGlvbiAodXNlcl9wb3N0cykge1xuXHRcdFx0XHRcdFx0JHNjb3BlLnVzZXJfcG9zdHMgPSB1c2VyX3Bvc3RzO1xuXHRcdFx0XHRcdFx0JHNjb3BlLnBhZ2luYXRlKCRzY29wZS51c2VyX3Bvc3RzLmxlbmd0aCk7XG5cdFx0XHRcdFx0fSlcblx0XHRcdH0pXG5cblx0XHQvKi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblx0XHQvIENoZWNrIGN1cnJlbnRseSBsb2dnZWQgaW4gdXNlciBcblx0XHQvLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi9cblxuXHRcdCRzY29wZS5jaGVja0xvZ2luID0gZnVuY3Rpb24oKSB7XG5cdFx0XHQvL2lzIGFueW9uZSBsb2dnZWQgaW5cblx0XHQgIFx0aWYgKHdpbmRvdy5sb2NhbFN0b3JhZ2UudG9rZW4pIHtcblx0XHRcdCAgXHQvL2dldCBjdXJyZW50IHVzZXJcblx0XHRcdCAgXHRVc2VyU3ZjLmdldFVzZXIoKVxuXHRcdFx0XHRcdC50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSl7XG5cdFx0XHRcdFx0XHQkc2NvcGUuY3VycmVudFVzZXIgPSByZXNwb25zZS5kYXRhO1xuXHRcdFx0XHRcdFx0XHQvL2lzIHRoZSB1c2VyIHRoZSBzYW1lIGFzIHRoZSB1c2VyIHdobydzIHBhZ2UgdGhpcyBpcyBvciB0aGV5IGhhdmUgYSBoaWdoZXIgcGVybWlzc2lvbiBsZXZlbCB0aGVuIGxldCB0aGVtIGVkaXQgdGhlIHBhZ2Vcblx0XHRcdFx0XHRcdFx0aWYgKCRzY29wZS51c2VyX3Byb2ZpbGUuX2lkID09ICRzY29wZS5jdXJyZW50VXNlci5faWQgfHwgJHNjb3BlLmVkaXRQZXJtaXNzaW9uKCRzY29wZS5jdXJyZW50VXNlci5wZXJtaXNzaW9uX2xldmVsKSApIHtcblx0XHRcdFx0XHRcdFx0XHQkc2NvcGUuY2FuRWRpdCA9IHRydWU7XG5cdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHR9KVxuXHRcdFx0fVxuXHRcdH07XG5cblx0XHQvKi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblx0XHQvIEVuZCB1c2VyIGNoZWNrIFxuXHRcdC8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qL1xuXG5cdFx0JHNjb3BlLmN1cnJlbnRVc2VyID0gW107XG5cblx0XHQkc2NvcGUuY2hlY2tMb2dpbigpO1xuXG5cdFx0JHNjb3BlLiRvbignJHZpZXdDb250ZW50TG9hZGVkJywgZnVuY3Rpb24oKXtcblx0XHRcdC8vdGhlIHBhZ2UgaXMgcmVhZHlcblx0XHR9KTtcblxuXHRcdC8qLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXHRcdC8gUGFnaW5hdGlvbiBcblx0XHQvLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi9cblxuXHRcdCRzY29wZS51c2VyX3Bvc3RzID0gW107XG5cblx0XHQkc2NvcGUuY3VycmVudFBhZ2UgPSAxO1xuXHRcdCRzY29wZS5wb3N0c1BlclBhZ2UgPSA1O1xuXG5cdFx0JHNjb3BlLnByZXZQYWdlID0gZnVuY3Rpb24gKCkge1xuXHQgICAgICAgIGlmICgkc2NvcGUuY3VycmVudFBhZ2UgPiAxKSB7XG5cdCAgICAgICAgICAgICRzY29wZS5jdXJyZW50UGFnZS0tO1xuXHQgICAgICAgIH1cblx0ICAgIH07XG4gICAgXG5cdCAgICAkc2NvcGUubmV4dFBhZ2UgPSBmdW5jdGlvbiAoKSB7XG5cdCAgICAgICAgaWYgKCRzY29wZS5jdXJyZW50UGFnZSA8ICRzY29wZS51c2VyX3Bvc3RzLmxlbmd0aC8kc2NvcGUucG9zdHNQZXJQYWdlKSB7XG5cdCAgICAgICAgICAgICRzY29wZS5jdXJyZW50UGFnZSsrO1xuXHQgICAgICAgIH1cblx0ICAgIH07XG5cdCAgICBcblx0ICAgICRzY29wZS5zZXRQYWdlID0gZnVuY3Rpb24gKHBhZ2VfbnVtYmVyKSB7XG5cdCAgICAgICAgJHNjb3BlLmN1cnJlbnRQYWdlID0gcGFnZV9udW1iZXI7XG5cdCAgICB9O1xuXG5cdCAgICAvL1RoaXMgd2F5IEkgY2FuIGRvOiAgXCI8bGkgbmctcmVwZWF0PVwibiBpbiByYW5nZShwYWdlcykgdHJhY2sgYnkgJGluZGV4XCI+XCIgYW5kIHNvIEkgY2FuIGRpc3BsYXkgYXMgbWFueSBpdGVtcyBhcyB0aGUgdmFsdWUgb2YgYSBudW1iZXIgYXMgdGhpcyByZXR1cm5zIGFuIGFycmF5IG9mIHRoYXQgbGVuZ2h0XG5cdCAgICAkc2NvcGUucmFuZ2UgPSBmdW5jdGlvbihuKSB7XG4gICAgICAgIFx0cmV0dXJuIG5ldyBBcnJheShuKTtcbiAgICBcdH07XG5cdCAgICBcblxuXHRcdCRzY29wZS5wYWdpbmF0ZSA9IGZ1bmN0aW9uKG51bWJlcl9vZl9pdGVtcyl7XG5cdCAgICBcdGlmIChudW1iZXJfb2ZfaXRlbXMgPiAwKSB7XG5cdCAgICAgICAgXHQkc2NvcGUubnVtYmVyT2ZQYWdlcyA9IE1hdGguY2VpbChudW1iZXJfb2ZfaXRlbXMvJHNjb3BlLnBvc3RzUGVyUGFnZSk7XG5cdCAgICAgICAgfVxuXHQgICAgICAgIGVsc2Uge1xuXHQgICAgICAgIFx0JHNjb3BlLm51bWJlck9mUGFnZXMgPSBNYXRoLmNlaWwoJHNjb3BlLnVzZXJfcG9zdHMubGVuZ3RoLyRzY29wZS5wb3N0c1BlclBhZ2UpO1xuXHQgICAgICAgIH1cblx0ICAgIH07XG5cblx0XHQkc2NvcGUucHJldHRpZnlDb2RlID0gZnVuY3Rpb24oKSB7XG5cdFx0XHRQUi5wcmV0dHlQcmludCgpO1xuXHRcdH07XG5cblx0ICAgIC8vVGhpcyB3YXkgSSBjYW4gZG86ICBcIjxsaSBuZy1yZXBlYXQ9XCJuIGluIHJhbmdlKHBhZ2VzKSB0cmFjayBieSAkaW5kZXhcIj5cIiBhbmQgc28gSSBjYW4gZGlzcGxheSBhcyBtYW55IGl0ZW1zIGFzIHRoZSB2YWx1ZSBvZiBhIG51bWJlciBhcyB0aGlzIHJldHVybnMgYW4gYXJyYXkgb2YgdGhhdCBsZW5naHRcblx0ICAgICRzY29wZS5yYW5nZSA9IGZ1bmN0aW9uKG4pIHtcbiAgICAgICAgXHRyZXR1cm4gbmV3IEFycmF5KG4pO1xuICAgIFx0fTtcblxuXHRcdC8qLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXHRcdC8gRW5kIFBhZ2luYXRpb24gXG5cdFx0Ly0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qL1xuXG5cdCAgXHRVc2VyU3ZjLmF1dGhvcml6YXRpb24oJzEwJylcblx0XHRcdC50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSl7XG5cdFx0XHRcdGNvbnNvbGUubG9nKHJlc3BvbnNlKTtcblx0XHRcdH0pXG5cblx0XHQvKi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblx0XHQvIFByb2ZpbGUgZWRpdCBvcHRpb25zIFxuXHRcdC8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi9cblxuXHRcdCRzY29wZS5zYXZlUHJvZmlsZSA9IGZ1bmN0aW9uICgpIHtcblxuXHRcdFx0Ly9nZXQgdGhlIGlkIG9mIHRoZSBjdXJyZW50bHkgbG9nZ2VkIGluIHVzZXIncyBJRC4gU28gd2UgY2FuIHVzZSB0aGlzIHRvIGVkaXQgdGhlIHVzZXIuIHRvZG86IGNoYW5nZSB0aGlzIHNvIHRoZSBzdXBlcnVzZXJzIGNhbiBjaG9vc2Ugd2hvIGlzIGVkaXRlZCB3aGVuIHRoZXkgdmlzaXQgdGhlIHBhZ2Vcblx0XHRcdHZhciBwcm9maWxlX2RldGFpbHMgPSB7XG5cdFx0XHRcdF9pZCA6ICRzY29wZS51c2VyX3Byb2ZpbGUuX2lkXG5cdFx0XHR9O1xuXG5cdFx0XHQvL2l0ZXJhdGUgdGhyb3VnaCB0aGUgbmV3IGRldGFpbHMsIGlmIHRoZXkgYXJlIG5vdCBlbXB0eSB0aGVuIGFkZCB0aGVtIHRvIHRoZSBwcm9maWxlIGRldGFpbHMgb2JqZWN0XG5cdFx0XHRmb3IgKHZhciBrZXkgaW4gJHNjb3BlLm5ldykge1xuXHRcdFx0ICBpZiAoJHNjb3BlLm5ldy5oYXNPd25Qcm9wZXJ0eShrZXkpKSB7XG5cdFx0XHQgICAgLy9hbGVydChrZXkgKyBcIiAtPiBcIiArICRzY29wZS5uZXdba2V5XSk7XG5cdFx0XHQgICAgaWYgKCRzY29wZS5uZXdba2V5XSAhPSAnJykge1xuXHRcdFx0ICAgIFx0cHJvZmlsZV9kZXRhaWxzW2tleV0gPSAkc2NvcGUubmV3W2tleV07XG5cdFx0XHQgICAgfVxuXHRcdFx0ICB9XG5cdFx0XHR9XG5cblx0XHRcdC8vc2VuZCB0aGlzIHByb2ZpbGUgZGV0YWlscyBvYmVqZWN0IHRvIHRoZSB1c2VyIHNlcnZpY2UuIFRoaXMgdGhlbiB1cGRhdGVkIG9yIGFkZHMgYWxsIGRldGFpbCBpbiB0aGlzIHRvIHRoZSB1c2VyIHdobydzIElEIHdhcyBzZWxlY3RlZCBlYXJsaWVyXG5cdFx0XHRVc2VyU3ZjLnByb2ZpbGVVcGRhdGUocHJvZmlsZV9kZXRhaWxzKVxuXHRcdFx0XHQuc3VjY2VzcyhmdW5jdGlvbiAodXNlcikge1xuXHRcdFx0XHRcdC8vY29uc29sZS5sb2codXNlcik7XG5cdFx0XHRcdFx0Ly9UaGUgdXNlcm5hbWUgaXMgdXNlZCBhcyBwYXJ0IG9mIHRoZSB1c2VycyBsb2dpbiB0b2tlbiwgc28gaWYgdGhlIHVzZXJuYW1lIGNoYW5nZXMgdGhlIHRva2VuIGlzIG5vIGxvbmdlciB2YWxpZCAodGhpcyBpcyBuZWVkZWQgZm9yIHNlY3VyaXR5IHJlYXNvbnMpXG5cdFx0XHRcdFx0Ly90aGVyZWZvcmUgY2hhbmdpbmcgYSB1c2VybmFtZSB3aWxsIGVmZmVjdGl2ZWx5IGxvZyBzb21lb25lIG91dC4gXG5cdFx0XHRcdFx0Ly9TbyB3ZSBuZWVkIHRvIGNoZWNrIGlmIHRoZWlyIHVzZXJuYW1lIHdhcyBjaGFuZ2VkLCBhbmQgaWYgaXQgd2FzIHRoZW4gc2VuZCB0aGVtIHRvIHRoZSBsb2dpbiBwYWdlIHNvIHRoZXkgY2FuIGxvZyBpbnRvIHRoZXkgYWNjb3VudCBhZ2lhbiBhbmQgZ2V0IGEgbmV3IHRva2VuXG5cdFx0XHRcdFx0aWYgKHVzZXIudXNlcm5hbWUgIT0gJHNjb3BlLnVzZXJfcHJvZmlsZS51c2VybmFtZSkge1xuXHRcdFx0XHRcdFx0JHNjb3BlLnJldHVybk1lc3NhZ2UgPSBcIllvdXIgdXNlcm5hbWUgd2FzIGNoYW5nZWQgc28geW91IG11c3QgbG9nIGluIGFnYWluXCI7XG5cdFx0XHRcdFx0XHRzZXRUaW1lb3V0KGZ1bmN0aW9uKCl7IFxuXHRcdFx0XHRcdFx0XHR3aW5kb3cubG9jYXRpb24uaHJlZj0gJy8jL2xvZ2luJztcblx0XHRcdFx0XHRcdH0sIDE1MDApO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0XHRlbHNlIHtcblx0XHRcdFx0XHRcdCRzY29wZS5yZXR1cm5NZXNzYWdlID0gXCJEZXRhaWxzIHVwZGF0ZWQgc3VjY2Vzc2Z1bGx5XCI7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFxuXHRcdFx0XHR9KVxuXHRcdH1cblxuXHRcdC8qLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXHRcdC8gRW5kIHByb2ZpbGUgZWRpdCBvcHRpb25zIFxuXHRcdC8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi9cblx0fV0pIiwiYW5ndWxhci5tb2R1bGUoJ2FwcCcpXG5cdC5jb250cm9sbGVyKCdSZWdpc3RlckN0cmwnICwgW1wiJHNjb3BlXCIgLCBcIlVzZXJTdmNcIiAsIGZ1bmN0aW9uICgkc2NvcGUsIFVzZXJTdmMpIHtcblx0XHQkc2NvcGUucmVnaXN0ZXIgPSBmdW5jdGlvbiAodXNlcm5hbWUsIHBhc3N3b3JkLCBwYXNzd29yZF9jb25maXJtKSB7XG5cdFx0XHRpZiAocGFzc3dvcmQgIT0gcGFzc3dvcmRfY29uZmlybSkge1xuXHRcdFx0XHQkc2NvcGUudmFsaWRhdGlvbk1lc3NhZ2UgPSAnWW91ciBwYXNzd29yZHMgZGlkIG5vdCBtYXRjaC4nO1xuXHRcdFx0XHRyZXR1cm47XG5cdFx0XHR9XG5cdFx0XHRVc2VyU3ZjLnJlZ2lzdGVyKHVzZXJuYW1lLCBwYXNzd29yZClcblx0XHR9XG5cdH1dKSIsImFuZ3VsYXIubW9kdWxlKCdhcHAnKVxuXHQuY29uZmlnKFtcIiRyb3V0ZVByb3ZpZGVyXCIsIGZ1bmN0aW9uICgkcm91dGVQcm92aWRlcikge1xuXHRcdCRyb3V0ZVByb3ZpZGVyXG5cdFx0XHQud2hlbignLycgLCB7Y29udHJvbGxlcjogJ1Bvc3RzQ3RybCcsIHRlbXBsYXRlVXJsOiAncG9zdC9hbGxQb3N0cy5odG1sJ30pXG5cdFx0XHQud2hlbignL3JlZ2lzdGVyJyAsIHtjb250cm9sbGVyOiAnUmVnaXN0ZXJDdHJsJywgdGVtcGxhdGVVcmw6ICdyZWdpc3Rlci5odG1sJ30pXG5cdFx0XHQud2hlbignL2xvZ2luJyAsIHtjb250cm9sbGVyOiAnTG9naW5DdHJsJywgdGVtcGxhdGVVcmw6ICdsb2dpbi5odG1sJ30pXG5cdFx0XHQud2hlbignL3Bvc3QvOnllYXIvOm1vbnRoLzpkYXkvOnNsdWcnICwge2NvbnRyb2xsZXI6ICdTaW5nbGVQb3N0Q3RybCcsIHRlbXBsYXRlVXJsOiAncG9zdC9zaW5nbGVQb3N0Lmh0bWwnfSlcblx0XHRcdC53aGVuKCcvcG9zdC9pZC86aWQnICwge2NvbnRyb2xsZXI6ICdTaW5nbGVQb3N0Q3RybCcsIHRlbXBsYXRlVXJsOiAnc2luZ2xlUG9zdC5odG1sJ30pXG5cdFx0XHQud2hlbignL3Bvc3QvbmV3LycgLCB7Y29udHJvbGxlcjogJ1Bvc3RzQ3RybCcsIHRlbXBsYXRlVXJsOiAncG9zdC9uZXdQb3N0Lmh0bWwnfSlcblx0XHRcdC53aGVuKCcvdXNlci86dXNlcm5hbWUnICwge2NvbnRyb2xsZXI6ICdQcm9maWxlQ3RybCcsIHRlbXBsYXRlVXJsOiAncG9zdC91c2VyUG9zdHMuaHRtbCd9KVxuXHRcdFx0LndoZW4oJy90YWcvOnRhZycgLCB7Y29udHJvbGxlcjogJ1RhZ0N0cmwnLCB0ZW1wbGF0ZVVybDogJ3Bvc3QvdGFnUGFnZS5odG1sJ30pXG5cdFx0XHQvLy53aGVuKCcvdXNlci86dXNlcm5hbWUvZWRpdCcgLCB7Y29udHJvbGxlcjogJ1Byb2ZpbGVDdHJsJywgdGVtcGxhdGVVcmw6ICdwcm9maWxlL3VzZXJQcm9maWxlLmh0bWwnfSlcblx0XHRcdC8vLndoZW4oJy91c2VyLzp1c2VybmFtZS9wcm9maWxlJyAsIHtjb250cm9sbGVyOiAnUHJvZmlsZUN0cmwnLCB0ZW1wbGF0ZVVybDogJ3Byb2ZpbGUvdXNlclZpZXcuaHRtbCd9KVxuXHR9XSkiLCJhbmd1bGFyLm1vZHVsZSgnYXBwJylcblx0LmNvbnRyb2xsZXIoJ1NpbmdsZVBvc3RDdHJsJywgW1wiJHNjb3BlXCIgLCBcIiRodHRwXCIsIFwiUG9zdHNTZXJ2aWNlXCIsIFwiJHJvdXRlUGFyYW1zXCIsIFwiJHJvdXRlXCIsIFwiJGxvY2F0aW9uXCIgLCBmdW5jdGlvbiAoJHNjb3BlLCAkaHR0cCwgUG9zdHNTZXJ2aWNlLCAkcm91dGVQYXJhbXMsICRyb3V0ZSwgJGxvY2F0aW9uKSB7XG5cblx0XHQkc2NvcGUuc2luZ2xlUG9zdFZpZXcgPSB0cnVlOyAvLyBtYWtlcyBpdCBhIGJpdCBlYXNpZXIgdG8gY2hhbmdlIHRoZSBzdHlsaW5nIG9mIHRoZSBwb3N0IG9uIGl0cyBzaW5nbGUgcG9zdCBwYWdlIHdoaWxlIHVzaW5nIHRoZSBzYW1lIHRlbXBsYXRlIGFzIHRoZSBtdWx0aSBwb3N0IHN1bW1hcnkgcGFnZXNcblxuXHRcdCRzY29wZS4kb24oJyR2aWV3Q29udGVudExvYWRlZCcsIGZ1bmN0aW9uKCl7XG5cdFx0XHQvL3RoZSBwYWdlIGlzIHJlYWR5XG5cdFx0fSk7XG5cblx0XHQkc2NvcGUuZGVsZXRlSXRlbSA9IGZ1bmN0aW9uICgpIHtcblx0XHRcdFBvc3RzU2VydmljZS5yZW1vdmVJdGVtKHtcblx0XHRcdFx0XHRwb3N0X2lkOiAkc2NvcGUucG9zdC5faWRcblx0XHRcdFx0fSlcblx0XHRcdFx0LnN1Y2Nlc3MoZnVuY3Rpb24gKHJlc3BvbnNlKSB7XG5cdFx0XHRcdFx0Y29uc29sZS5sb2cocmVzcG9uc2UpO1xuXHRcdFx0XHRcdC8vIGNvbmZpcm0gc3VjY2Vzc2Z1bCBkZWxldGVcblx0XHRcdFx0fSlcblx0XHR9O1xuXG5cdFx0JHNjb3BlLnByZXR0aWZ5Q29kZSA9IGZ1bmN0aW9uKCkge1xuXHRcdFx0UFIucHJldHR5UHJpbnQoKTtcblx0XHR9O1xuXG4gICAgICAgIHZhciBwb3N0U2x1ZyA9ICRyb3V0ZVBhcmFtcy5zbHVnO1xuICAgICAgICB2YXIgcG9zdElEID0gJHJvdXRlUGFyYW1zLmlkO1xuXG5cdFx0aWYgKHBvc3RTbHVnKSB7XG4gICAgICAgICAgICB2YXIgZnVsbFBvc3RTbHVnID0gJyc7XG4gICAgICAgICAgICBmdWxsUG9zdFNsdWcgKz0gJHJvdXRlUGFyYW1zLnllYXIgKyAnLyc7XG4gICAgICAgICAgICBmdWxsUG9zdFNsdWcgKz0gJHJvdXRlUGFyYW1zLm1vbnRoICsgJy8nO1xuICAgICAgICAgICAgZnVsbFBvc3RTbHVnICs9ICRyb3V0ZVBhcmFtcy5kYXkgKyAnLyc7XG4gICAgICAgICAgICBmdWxsUG9zdFNsdWcgKz0gJHJvdXRlUGFyYW1zLnNsdWc7XG5cbiAgICAgICAgICAgIFBvc3RzU2VydmljZS5zaW5nbGVfc2x1Zyh7XG5cdFx0XHRcdHNsdWc6IGZ1bGxQb3N0U2x1Z1xuXHRcdFx0fSlcblx0XHRcdC5zdWNjZXNzKGZ1bmN0aW9uIChwb3N0KSB7XG5cdFx0XHRcdCRzY29wZS5wb3N0ID0gcG9zdFswXTtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygkc2NvcGUucG9zdCk7XG4gICAgICAgICAgICB9KVxuXHRcdH1cblx0XHRlbHNlIGlmIChwb3N0SUQpIHtcblx0XHRcdFBvc3RzU2VydmljZS5zaW5nbGVfaWQoe1xuXHRcdFx0XHRpZDogcG9zdElEXG5cdFx0XHR9KVx0XHRcblx0XHRcdC5zdWNjZXNzKGZ1bmN0aW9uIChwb3N0KSB7XG5cdFx0XHRcdCRzY29wZS5wb3N0ID0gcG9zdFswXTtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygkc2NvcGUucG9zdCk7XG5cdFx0XHR9KVxuXHRcdH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAvLyB0aGUgdXJsIGRvZXMgbm90IGNvbnRhaW4gYSB2YWxpZCBwb3N0IHNsdWcgb3IgaWRcbiAgICAgICAgICAgIC8vIHNob3cgZXJyb3IgdG8gdXNlclxuICAgICAgICB9XG5cblx0fV0pIiwiLyoqXG4gKiBDcmVhdGVkIGJ5IHRvbWkgb24gMDUvMDMvMTYuXG4gKi9cblxuYW5ndWxhci5tb2R1bGUoJ2FwcCcpXG4gICAgLmNvbnRyb2xsZXIoJ1RhZ0N0cmwnLCBbXCIkc2NvcGVcIiAsIFwiJGh0dHBcIiwgXCJVc2VyU3ZjXCIsIFwiUG9zdHNTZXJ2aWNlXCIgLCBcIiRyb3V0ZVBhcmFtc1wiLCBcIiRyb3V0ZVwiLCBcIiRsb2NhdGlvblwiICwgZnVuY3Rpb24gKCRzY29wZSwgJGh0dHAsIFVzZXJTdmMsIFBvc3RzU2VydmljZSwgJHJvdXRlUGFyYW1zLCAkcm91dGUsICRsb2NhdGlvbikge1xuXG4gICAgICAgICRzY29wZS5iYXNlVXJsID0gbG9jYXRpb24uaG9zdDtcbiAgICAgICAgdmFyIHRhZyA9ICRyb3V0ZVBhcmFtcy50YWc7XG4gICAgICAgICRzY29wZS5uZXcgID0ge307XG5cbiAgICAgICAgJHNjb3BlLnRhZ1RpdGxlID0gdGFnO1xuXG4gICAgICAgICRzY29wZS5wcmV0dGlmeUNvZGUgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIFBSLnByZXR0eVByaW50KCk7XG4gICAgICAgIH07XG5cbiAgICAgICAgUG9zdHNTZXJ2aWNlLmZpbHRlcmVkX3Bvc3RzICh7XG4gICAgICAgICAgICAgICAgdGFnczogdGFnXG4gICAgICAgICAgICB9KVxuICAgICAgICAgICAgLnN1Y2Nlc3MoZnVuY3Rpb24gKHRhZ2dlZFBvc3RzKSB7XG4gICAgICAgICAgICAgICAgJHNjb3BlLnBvc3RzID0gdGFnZ2VkUG9zdHM7XG4gICAgICAgICAgICB9KTtcbiAgICB9XSkiLCJhbmd1bGFyLm1vZHVsZSgnYXBwJylcblx0LnNlcnZpY2UoJ1VzZXJTdmMnLCBbXCIkaHR0cFwiLCBmdW5jdGlvbigkaHR0cCkge1xuXHRcdHZhciBzdmMgPSB0aGlzO1xuXG5cdFx0c3ZjLmdldFVzZXIgPSBmdW5jdGlvbiAoKSB7XG5cdFx0XHQkaHR0cC5kZWZhdWx0cy5oZWFkZXJzLmNvbW1vblsnWC1BdXRoJ10gPSB3aW5kb3cubG9jYWxTdG9yYWdlLnRva2VuXG5cdFx0XHRyZXR1cm4gJGh0dHAuZ2V0KCcvYXBpL3VzZXJzJylcblx0XHRcdC50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkge1xuICAgICAgXHRcdFx0cmV0dXJuIHJlc3BvbnNlXG4gICAgXHRcdH0pXG5cdFx0fVxuXG5cdFx0c3ZjLmxvZ2luID0gZnVuY3Rpb24gKHVzZXJuYW1lLCBwYXNzd29yZCkge1xuXHRcdFx0cmV0dXJuICRodHRwLnBvc3QoJy9hcGkvc2Vzc2lvbnMnLCB7XG5cdFx0XHRcdHVzZXJuYW1lOiB1c2VybmFtZSwgcGFzc3dvcmQ6IHBhc3N3b3JkXG5cdFx0XHR9KVxuXHRcdFx0LnRoZW4oZnVuY3Rpb24gKHZhbCkge1xuXHRcdFx0XHR3aW5kb3cubG9jYWxTdG9yYWdlLnRva2VuID0gdmFsLmRhdGE7XG5cdFx0XHRcdCRodHRwLmRlZmF1bHRzLmhlYWRlcnMuY29tbW9uWydYLUF1dGgnXSA9IHZhbC5kYXRhXG5cdFx0XHRcdHJldHVybiBzdmMuZ2V0VXNlcigpO1xuXHRcdFx0fSlcblx0XHR9XG5cblx0XHRzdmMucmVnaXN0ZXIgPSBmdW5jdGlvbiAodXNlcm5hbWUsIHBhc3N3b3JkLCBwYXNzd29yZF9jb25maXJtKSB7XG5cdFx0XHRyZXR1cm4gJGh0dHAucG9zdCgnL2FwaS91c2VycycsIHtcblx0XHRcdFx0dXNlcm5hbWU6IHVzZXJuYW1lLCBwYXNzd29yZDogcGFzc3dvcmRcblx0XHRcdH0pXG5cdFx0XHQudGhlbihmdW5jdGlvbiAodmFsKSB7XG5cdFx0XHRcdHJldHVybiBzdmMubG9naW4odXNlcm5hbWUsIHBhc3N3b3JkKVxuXHRcdFx0XHRcdC50aGVuKGZ1bmN0aW9uKCl7XG5cdFx0XHRcdFx0XHR3aW5kb3cubG9jYXRpb24uaHJlZj0gJy8nO1xuXHRcdFx0XHRcdH0pXG5cdFx0XHR9KVxuXHRcdH1cblxuXHRcdHN2Yy5hdXRob3JpemF0aW9uID0gZnVuY3Rpb24gKHBlcm1pc3Npb25fbGV2ZWwpIHtcblx0XHRcdCRodHRwLmRlZmF1bHRzLmhlYWRlcnMuY29tbW9uWydYLUF1dGgnXSA9IHdpbmRvdy5sb2NhbFN0b3JhZ2UudG9rZW47XG5cdFx0XHRyZXR1cm4gJGh0dHAuZ2V0KCcvYXBpL3VzZXJzL3Blcm1pc3Npb25zJylcblx0XHRcdC50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkge1xuXHRcdFx0XHRjb25zb2xlLmxvZyhyZXNwb25zZSk7XG5cdFx0XHRcdGlmIChyZXNwb25zZS5kYXRhID4gcGVybWlzc2lvbl9sZXZlbCkge1xuXHRcdFx0XHRcdHJldHVybiB0cnVlO1xuXHRcdFx0XHR9XG5cdFx0XHRcdHJldHVybiBmYWxzZTtcblx0XHRcdH0pXG5cdFx0fVxuXG5cdFx0c3ZjLmxvZ291dCA9IGZ1bmN0aW9uICgpIHtcblx0XHRcdHdpbmRvdy5sb2NhbFN0b3JhZ2UucmVtb3ZlSXRlbSgndG9rZW4nKTtcblx0XHRcdHdpbmRvdy5sb2NhdGlvbi5ocmVmPSAnLyc7XG5cdFx0fVxuXG5cdFx0c3ZjLnByb2ZpbGUgPSBmdW5jdGlvbiAodXNlcm5hbWUpIHtcblx0XHRcdHJldHVybiAkaHR0cC5nZXQoJy9hcGkvdXNlcnMvcHJvZmlsZScsIHsgcGFyYW1zOiB7dXNlcm5hbWU6IHVzZXJuYW1lfSB9KVxuXHRcdH1cblxuXHRcdHN2Yy5wcm9maWxlVXBkYXRlID0gZnVuY3Rpb24gKHByb2ZpbGUpIHtcblx0XHRcdHJldHVybiAkaHR0cC5wb3N0KCcvYXBpL3VzZXJzL3Byb2ZpbGUnLCBwcm9maWxlIClcblx0XHR9XG5cdH1dKSIsImFuZ3VsYXIubW9kdWxlKCdhcHAnKVxuLnJ1bihbXCIkcm9vdFNjb3BlXCIsIFwiJHRpbWVvdXRcIiAsIFwiJHdpbmRvd1wiICwgZnVuY3Rpb24gKCRyb290U2NvcGUsICR0aW1lb3V0LCAkd2luZG93KSB7XG5cblx0dmFyIHJlY29ubmVjdF9kZWxheSA9IDEwO1xuXHRcblx0KGZ1bmN0aW9uIGNvbm5lY3QoKXtcblx0XHQvL2luY3JlbWVudCB0aGUgcmVjb25uZWN0IGRlbGF5IHRpbWVlclxuXHRcdHJlY29ubmVjdF9kZWxheSArPSByZWNvbm5lY3RfZGVsYXk7XG5cblx0XHQvL0NyZWF0ZSBhIHdlYnNvY2tldCBjb25uZWN0aW9uIHdpdGggdGhlIHNlcnZlclxuXHRcdHZhciBob3N0ID0gXCJ3czovL1wiICsgJHdpbmRvdy5sb2NhdGlvbi5ob3N0XG5cdFx0ICBcblx0XHR2YXIgY29ubmVjdGlvbiA9IG5ldyBXZWJTb2NrZXQoaG9zdClcblxuXHRcdGNvbm5lY3Rpb24ub25vcGVuID0gZnVuY3Rpb24gKCkge1xuXHRcdFx0Ly9jb25zb2xlLmxvZygnV2Vic29ja2V0IGNvbm5lY3RlZCcpXG5cdFx0fVxuXG5cblx0XHRjb25uZWN0aW9uLm9uY2xvc2UgPSBmdW5jdGlvbiAoZSkge1xuXHRcdFx0Y29uc29sZS5sb2coJ1dlYnNvY2tldCBjb25uZWN0aW9uIGNsb3NlZC4gQXR0ZW1wdGluZyB0byByZWNjb25uZWN0IGluICcgKyByZWNvbm5lY3RfZGVsYXkgKyAnIHNlY29uZHMnIClcblxuXHRcdFx0JHRpbWVvdXQoY29ubmVjdCwgcmVjb25uZWN0X2RlbGF5KjEwMDApO1xuXHRcdH0gXG5cblx0XHRjb25uZWN0aW9uLm9ubWVzc2FnZSA9IGZ1bmN0aW9uIChlKSB7XG5cdFx0XHQvL2NvbnNvbGUubG9nKGUpO1xuXHRcdFx0dmFyIG1lc3NhZ2UgPSBKU09OLnBhcnNlKGUuZGF0YSk7XG5cdFx0XHRcblx0XHRcdHZhciBuYW1lID0gJ3dzOicgKyBtZXNzYWdlLnRvcGljO1xuXHRcdFx0dmFyIGRhdGEgPSBtZXNzYWdlLmRhdGE7XG5cdFx0XHQvL2NvbnNvbGUubG9nKFwiYnJvYWRjYXN0aW5nOiBcIik7XG5cblx0XHRcdCRyb290U2NvcGUuJGJyb2FkY2FzdChuYW1lLCBkYXRhKTtcblx0XHR9XG5cdH0pKClcbn1dKSJdLCJzb3VyY2VSb290IjoiL3NvdXJjZS8ifQ==